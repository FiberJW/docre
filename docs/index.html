
<html>
<head>
<title>Reason code</title>
<script>

</script>
<style>
body {
  padding: 30px;
}
.value-identifier {
    color: #000;
}

.module-identifier {
  color: #aa0;
}

.type-value-identifier,
.type-module-identifier {
  color: #1400a5;
}

.open-module-identifier,
.type-module-identifier,
.let-module-identifier,
.constructor-module-identifier,
.switch-module-identifier,
.record-module-identifier,
.field-module-identifier {
  color: #a0a;
}

.open-value-identifier,
.let-value-identifier,
.switch-value-identifier,
.record-value-identifier,
.field-value-identifier {
  color: #0aa;
}

.unused-identifier {
  color: #00a;
}

.declaration-var {
  color: #a50000;
}

.string {
    color: #33a20d;
}

.int {
    color: #5656cc;
}

.boolean {
    color: #ff8f8f;
}

.float {
    color: #d49523;
}

.operator {
  color: #9b9bff;
  font-weight: bold;
}

#main {
    color: #aaa;
    white-space: pre;
    font-family: 'sf mono', monospace;
}
.hovered {
  background-color: #d4ffe2;
}

.type-hovered {
  outline: 1px solid #aaa;
}

/* span {
  display: inline-block;
  position: relative;
}
.id-badge {
  position: absolute;
  font-size: 0.5em;
  top: 100%;
  left: 0;
} */

[data-global]:not(.operator) {
  /* font-style: italic; */
  /* background-color: #fff3f2; */
  /* text-decoration: underline;
  text-decoration-color: rgba(0, 0, 0, 0.5);
  text-decoration-style: dashed; */
}

.open-exposing {
  box-shadow: 0 0 2px #d2d2d2;
  border-radius: 3px;
  padding: 0 2px;
}

.open-record,
.open-type {
  color: #1400a5;
}

.open-value {
  color: #000;
}


/* .module-identifier,
.let-module-identifier,
.constructor-module-identifier,
.switch-module-identifier,
.record-module-identifier,
.field-module-identifier,
.let-value-identifier,
.switch-value-identifier,
.record-value-identifier,
.field-value-identifier,
.unused-identifier,
.declaration-var {
  color: #000;
} */

#type_hover {
  position: absolute;
  margin-top: 30px;
  margin-left: 10px;
  padding: 5px 10px;
  box-sizing: border-box;
  font-family: 'sf mono', monospace;
  background-color: white;
  box-shadow: 0 0 2px #aaa;
}

</style>
<pre id="main">open Pervasives <span class="open-exposing">exposing (<span class="open-value" data-id="value: Pervasives!.!=">!=</span>, <span class="open-value" data-id="value: Pervasives!.&&">&&</span>, <span class="open-value" data-id="value: Pervasives!.*.">*.</span>, <span class="open-value" data-id="value: Pervasives!.+">+</span>, <span class="open-value" data-id="value: Pervasives!.+.">+.</span>, <span class="open-value" data-id="value: Pervasives!.-.">-.</span>, <span class="open-value" data-id="value: Pervasives!./.">/.</span>, <span class="open-value" data-id="value: Pervasives!.<"><</span>, <span class="open-value" data-id="value: Pervasives!.<>"><></span>, <span class="open-value" data-id="value: Pervasives!.=">=</span>, <span class="open-value" data-id="value: Pervasives!.==">==</span>, <span class="open-value" data-id="value: Pervasives!.>">></span>, <span class="open-value" data-id="value: Pervasives!.>=">>=</span>, <span class="open-value" data-id="value: Pervasives!.abs_float">abs_float</span>, <span class="open-value" data-id="value: Pervasives!.float_of_int">float_of_int</span>, <span class="open-value" data-id="value: Pervasives!.int_of_float">int_of_float</span>, <span class="open-value" data-id="value: Pervasives!.mod">mod</span>, <span class="open-value" data-id="value: Pervasives!.mod_float">mod_float</span>, <span class="open-value" data-id="value: Pervasives!.not">not</span>, <span class="open-value" data-id="value: Pervasives!.|>">|></span>, <span class="open-value" data-id="value: Pervasives!.||">||</span>, <span class="open-value" data-id="value: Pervasives!.~-.">~-.</span>)</span>
open <span class="open-module-identifier" data-id="module: Play_types!">Play_types</span> <span class="open-exposing">exposing (<span class="open-value" data-id="value: Play_types!.blockPos">blockPos</span>, <span class="open-value" data-id="value: Play_types!.blockSize">blockSize</span>, <span class="open-value" data-id="value: Play_types!.find">find</span>, <span class="open-value" data-id="value: Play_types!.gameWidth">gameWidth</span>, <span class="open-value" data-id="value: Play_types!.getBlock">getBlock</span>, <span class="open-value" data-id="value: Play_types!.loopx">loopx</span>, <span class="open-value" data-id="value: Play_types!.storageKey">storageKey</span>, <span class="open-value" data-id="value: Play_types!.Player.force">Player.force</span>, <span class="open-value" data-id="value: Play_types!.Stone.force">Stone.force</span>, <span class="open-record" data-id="type: Play_types!.Stone.t">Stone.t</span> {<span class="open-record-attribute" data-id="attr: Play_types!.Stone.t - vel">vel</span>, <span class="open-record-attribute" data-id="attr: Play_types!.Stone.t - circle">circle</span>}, <span class="open-record" data-id="type: Play_types!.userInput">userInput</span> {<span class="open-record-attribute" data-id="attr: Play_types!.userInput - up">up</span>, <span class="open-record-attribute" data-id="attr: Play_types!.userInput - right">right</span>, <span class="open-record-attribute" data-id="attr: Play_types!.userInput - left">left</span>, <span class="open-record-attribute" data-id="attr: Play_types!.userInput - jump">jump</span>, <span class="open-record-attribute" data-id="attr: Play_types!.userInput - down">down</span>, <span class="open-record-attribute" data-id="attr: Play_types!.userInput - action">action</span>}, <span class="open-record" data-id="type: Play_types!.state">state</span> {<span class="open-record-attribute" data-id="attr: Play_types!.state - zoom">zoom</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - userInput">userInput</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - stones">stones</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - player">player</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - paused">paused</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - lastSavedHighScore">lastSavedHighScore</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - hitByHit">hitByHit</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - frameByFrame">frameByFrame</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - camera">camera</span>, <span class="open-record-attribute" data-id="attr: Play_types!.state - blocks">blocks</span>}, <span class="open-record" data-id="type: Play_types!.player">player</span> {<span class="open-record-attribute" data-id="attr: Play_types!.player - walkTimer">walkTimer</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - vel">vel</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - throw">throw</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - isOnGround">isOnGround</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - inventory">inventory</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - facingLeft">facingLeft</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - box">box</span>, <span class="open-record-attribute" data-id="attr: Play_types!.player - actionTimer">actionTimer</span>}, <span class="open-record" data-id="type: Play_types!.Block.t">Block.t</span> {<span class="open-record-attribute" data-id="attr: Play_types!.Block.t - kind">kind</span>}, <span class="open-type" data-id="type: Play_types!.Block.blockKind">Block.blockKind</span> (<span class="open-type-constructor" data-id="constr: Play_types!.Block.blockKind - Rock">Rock</span>), <span class="open-type" data-id="type: Play_types!.Inventory.item">Inventory.item</span> (<span class="open-type-constructor" data-id="constr: Play_types!.Inventory.item - Stone">Stone</span>|<span class="open-type-constructor" data-id="constr: Play_types!.Inventory.item - Nothing">Nothing</span>))</span>;

<span class="type" data-type="1427"><span class="string">/** Update the saved high score if needed. */</span>
let <span class="type" data-type="773"><span class="declaration-var" data-id="value: maybeSave/1054">maybeSave</span></span> = <span class="type" data-type="563">(<span class="type" data-type="1292"><span class="declaration-var" data-id="value: state/1055">state</span></span>, <span class="type" data-type="776"><span class="type" data-type="132"><span class="declaration-var" data-id="value: env/1056">env</span></span>) => <span class="type" data-type="1210">{
  <span class="type" data-type="682">let <span class="type" data-type="718"><span class="declaration-var" data-id="value: num/1057">num</span></span> = <span class="type" data-type="1145"><span class="type" data-type="42"><span class="module-identifier" data-id="module: List!">List</span>.<span class="value-identifier" data-id="value: List!.length">length</span></span>(<span class="type" data-type="709"><span class="type" data-type="123"><span class="value-identifier" data-id="value: state/1055">state</span></span>.<span class="type" data-type="159"><span class="field-value-identifier" data-id="attr: Play_types!.state - stones">stones</span></span></span>)</span></span>;
  <span class="type" data-type="283">if <span class="type" data-type="428">(<span class="type" data-type="532"><span class="type" data-type="290"><span class="value-identifier" data-id="value: state/1055">state</span></span>.<span class="type" data-type="887"><span class="field-value-identifier" data-id="attr: Play_types!.state - lastSavedHighScore">lastSavedHighScore</span></span></span> <span class="type" data-type="1314"><span class="operator" data-id="value: Pervasives!.<"><</span></span> <span class="type" data-type="418"><span class="value-identifier" data-id="value: num/1057">num</span></span>)</span> <span class="type" data-type="580">{
    if <span class="type" data-type="621">(<span class="type" data-type="400"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.saveUserData">saveUserData</span></span>(~key=<span class="type" data-type="1201"><span class="value-identifier" data-id="value: Play_types!.storageKey">storageKey</span></span>, ~value=<span class="type" data-type="722"><span class="value-identifier" data-id="value: num/1057">num</span></span>, <span class="type" data-type="846"><span class="value-identifier" data-id="value: env/1056">env</span></span>))</span> <span class="type" data-type="279">{
      {...<span class="type" data-type="643"><span class="value-identifier" data-id="value: state/1055">state</span></span>, <span class="type" data-type="928"><span class="record-value-identifier" data-id="attr: Play_types!.state - lastSavedHighScore">lastSavedHighScore</span>: <span class="type" data-type="181"><span class="value-identifier" data-id="value: num/1057">num</span></span>}
    }</span></span> else <span class="type" data-type="350">{
      <span class="value-identifier" data-id="value: state/1055">state</span>
    }</span>
  }</span> else <span class="type" data-type="1078">{
    <span class="value-identifier" data-id="value: state/1055">state</span>
  }</span></span>
}</span></span></span></span>;

<span class="type" data-type="1033">let <span class="type" data-type="824"><span class="declaration-var" data-id="value: maxWalk/1067">maxWalk</span></span> = <span class="type" data-type="495"><span class="float">5.</span></span></span>;
<span class="type" data-type="635">let <span class="type" data-type="701"><span class="declaration-var" data-id="value: walkSpeed/1068">walkSpeed</span></span> = <span class="type" data-type="1100"><span class="float">0.5</span></span></span>;

let module <span class="declaration-var" data-id="module: MovePlayer/1079">MovePlayer</span> = Play_collide.Mover({
  <span class="type" data-type="627">let <span class="type" data-type="45"><span class="declaration-var" data-id="value: gravity/1069">gravity</span></span> = <span class="type" data-type="1494"><span class="float">0.5</span></span></span>;
  <span class="type" data-type="1176">let <span class="type" data-type="708"><span class="declaration-var" data-id="value: friction/1070">friction</span></span> = <span class="type" data-type="807"><span class="float">0.7</span></span></span>;
  <span class="type" data-type="504">let <span class="type" data-type="427"><span class="declaration-var" data-id="value: jump/1071">jump</span></span> = <span class="type" data-type="601"><span class="float">11.</span></span></span>;
  <span class="type" data-type="712">let <span class="type" data-type="1293"><span class="declaration-var" data-id="value: bounce/1072">bounce</span></span> = <span class="type" data-type="1219"><span class="boolean">false</span></span></span>;
});

<span class="type" data-type="478"><span class="string">/** Check if we have a collision below with a stone that's not moving.
 *
 * If this is true, then we'll be able to jump, even if we're not standing on a block.
 */</span>
let <span class="type" data-type="96"><span class="declaration-var" data-id="value: isStationaryStoneBelow/1080">isStationaryStoneBelow</span></span> = <span class="type" data-type="738">(<span class="type" data-type="1345"><span class="declaration-var" data-id="value: stones/1081">stones</span></span>, <span class="type" data-type="1097"><span class="type" data-type="336"><span class="declaration-var" data-id="value: player/1082">player</span></span>) => <span class="type" data-type="218">{
  <span class="type" data-type="1272">let <span class="type" data-type="40"><span class="declaration-var" data-id="value: above/1083">above</span></span> = <span class="type" data-type="1140"><span class="type" data-type="982"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.push">push</span></span>(<span class="type" data-type="664"><span class="type" data-type="210"><span class="value-identifier" data-id="value: player/1082">player</span></span>.<span class="type" data-type="1048"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>, <span class="type" data-type="562">{<span class="type" data-type="111"><span class="record-module-identifier" data-id="module: Geom!">Geom</span>.<span class="record-value-identifier" data-id="attr: Geom!.vector - theta">theta</span>:<span class="operator" data-id="value: Pervasives!.~-."> <span class="type" data-type="696"><span class="type" data-type="113">-.</span></span><span class="type" data-type="711"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.halfPi">halfPi</span></span></span>, <span class="type" data-type="927"><span class="record-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span>: <span class="type" data-type="425"><span class="float">15.</span></span>}</span></span></span>)</span></span>;
  <span class="type" data-type="1376"><span class="type" data-type="136">let <span class="type" data-type="32"><span class="declaration-var" data-id="value: below/1102">below</span></span> = <span class="type" data-type="873"><span class="type" data-type="300"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.push">push</span></span>(<span class="type" data-type="785"><span class="type" data-type="678"><span class="value-identifier" data-id="value: player/1082">player</span></span>.<span class="type" data-type="801"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>, <span class="type" data-type="806">{<span class="type" data-type="289"><span class="record-module-identifier" data-id="module: Geom!">Geom</span>.<span class="record-value-identifier" data-id="attr: Geom!.vector - theta">theta</span>: <span class="type" data-type="864"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.halfPi">halfPi</span></span>, <span class="type" data-type="423"><span class="record-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span>: <span class="type" data-type="235"><span class="float">0.1</span></span>}</span></span></span>)</span></span>;
  <span class="type" data-type="1470"><span class="type" data-type="223"><span class="module-identifier" data-id="module: List!">List</span>.<span class="value-identifier" data-id="value: List!.exists">exists</span></span>(<span class="type" data-type="754"><span class="type" data-type="658"><span class="declaration-var" data-id="value: stone/1103">stone</span></span> => <span class="type" data-type="224">{
    <span class="type" data-type="1309"><span class="type" data-type="1028"><span class="type" data-type="797"><span class="value-identifier" data-id="value: Pervasives!.abs_float">abs_float</span></span>(<span class="type" data-type="1158"><span class="type" data-type="585"><span class="type" data-type="385"><span class="value-identifier" data-id="value: stone/1103">stone</span></span>.<span class="type" data-type="1012"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - vel">vel</span></span></span>.<span class="type" data-type="307"><span class="field-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span></span></span>)</span> <span class="type" data-type="381"><span class="operator" data-id="value: Pervasives!.<"><</span></span> <span class="type" data-type="988"><span class="float">1.</span></span></span>
    <span class="type" data-type="1177"><span class="operator" data-id="value: Pervasives!.&&">&<span class="operator" data-id="value: Pervasives!.not">&</span></span> <span class="type" data-type="1138"><span class="type" data-type="465"><span class="type" data-type="464">!</span></span><span class="type" data-type="510"><span class="type" data-type="309"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.testCircle">testCircle</span></span>(<span class="type" data-type="791"><span class="value-identifier" data-id="value: above/1083">above</span></span>, <span class="type" data-type="872"><span class="type" data-type="488"><span class="value-identifier" data-id="value: stone/1103">stone</span></span>.<span class="type" data-type="557"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>)</span></span>
    <span class="type" data-type="25"><span class="operator" data-id="value: Pervasives!.&&">&&</span></span> <span class="type" data-type="999"><span class="type" data-type="244"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.testCircle">testCircle</span></span>(<span class="type" data-type="1375"><span class="value-identifier" data-id="value: below/1102">below</span></span>, <span class="type" data-type="657"><span class="type" data-type="597"><span class="value-identifier" data-id="value: stone/1103">stone</span></span>.<span class="type" data-type="125"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>)</span></span>
  }</span></span>, <span class="type" data-type="319"><span class="value-identifier" data-id="value: stones/1081">stones</span></span>)</span></span>
}</span></span></span></span>;

<span class="type" data-type="1331"><span class="string">/** Handle player movement. */</span>
let <span class="type" data-type="995"><span class="declaration-var" data-id="value: movePlayer/1117">movePlayer</span></span> = <span class="type" data-type="981">(<span class="type" data-type="828"><span class="declaration-var" data-id="value: userInput/1118">userInput</span></span>, <span class="type" data-type="729"><span class="type" data-type="302"><span class="declaration-var" data-id="value: player/1119">player</span></span>, <span class="type" data-type="1058"><span class="type" data-type="104"><span class="declaration-var" data-id="value: stones/1120">stones</span></span>, <span class="type" data-type="1328"><span class="type" data-type="1320"><span class="declaration-var" data-id="value: blocks/1121">blocks</span></span>, <span class="type" data-type="1408"><span class="type" data-type="320"><span class="declaration-var" data-id="value: timeScale/1122">timeScale</span></span>) => <span class="type" data-type="1287">{
  <span class="type" data-type="33">let <span class="type" data-type="541"><span class="declaration-var" data-id="value: vx/1123">vx</span></span> = <span class="type" data-type="215"><span class="type" data-type="39"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.vx">vx</span></span>(<span class="type" data-type="1386"><span class="type" data-type="840"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="156"><span class="field-value-identifier" data-id="attr: Play_types!.player - vel">vel</span></span></span>)</span></span>;
  <span class="type" data-type="1074"><span class="type" data-type="345">let <span class="type" data-type="531"><span class="declaration-var" data-id="value: acc/1124">acc</span></span> = <span class="type" data-type="1478"><span class="type" data-type="1118"><span class="type" data-type="246"><span class="value-identifier" data-id="value: userInput/1118">userInput</span></span>.<span class="type" data-type="406"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span></span> <span class="type" data-type="375"><span class="boolean">?</span></span> <span class="type" data-type="1135">(<span class="type" data-type="883"><span class="type" data-type="99"><span class="value-identifier" data-id="value: vx/1123">vx</span></span> <span class="type" data-type="351"><span class="operator" data-id="value: Pervasives!.>">></span></span><span class="operator" data-id="value: Pervasives!.~-."> <span class="type" data-type="1480"><span class="type" data-type="212">-.</span></span> <span class="type" data-type="996"><span class="value-identifier" data-id="value: maxWalk/1067">maxWalk</span></span></span></span> <span class="type" data-type="1065"><span class="boolean">?</span></span> <span class="type" data-type="895">Geom <span class="open-exposing">exposing (<span class="open-value" data-id="value: Geom!.pi">pi</span>, <span class="open-record" data-id="type: Geom!.vector">vector</span> {<span class="open-record-attribute" data-id="attr: Geom!.vector - theta">theta</span>, <span class="open-record-attribute" data-id="attr: Geom!.vector - magnitude">magnitude</span>})</span>.{<span class="type" data-type="768"><span class="record-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span>: <span class="type" data-type="1175"><span class="value-identifier" data-id="value: walkSpeed/1068">walkSpeed</span></span>, <span class="type" data-type="575"><span class="record-value-identifier" data-id="attr: Geom!.vector - theta">theta</span>: <span class="type" data-type="1495"><span class="value-identifier" data-id="value: Geom!.pi">pi</span></span>}</span></span></span> <span class="type" data-type="463"><span class="boolean">:</span></span> <span class="type" data-type="1305"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.v0">v0</span></span>)</span> <span class="type" data-type="520"><span class="boolean">:</span></span> <span class="type" data-type="438">(
    <span class="type" data-type="264"><span class="type" data-type="193"><span class="value-identifier" data-id="value: userInput/1118">userInput</span></span>.<span class="type" data-type="1422"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span></span> <span class="type" data-type="819"><span class="boolean">?</span></span> <span class="type" data-type="471">(<span class="type" data-type="1264"><span class="type" data-type="710"><span class="value-identifier" data-id="value: vx/1123">vx</span></span> <span class="type" data-type="82"><span class="operator" data-id="value: Pervasives!.<"><</span></span> <span class="type" data-type="110"><span class="value-identifier" data-id="value: maxWalk/1067">maxWalk</span></span></span> <span class="type" data-type="131"><span class="boolean">?</span></span> <span class="type" data-type="890">Geom <span class="open-exposing">exposing (<span class="open-record" data-id="type: Geom!.vector">vector</span> {<span class="open-record-attribute" data-id="attr: Geom!.vector - theta">theta</span>, <span class="open-record-attribute" data-id="attr: Geom!.vector - magnitude">magnitude</span>})</span>.{<span class="type" data-type="1246"><span class="record-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span>: <span class="type" data-type="856"><span class="value-identifier" data-id="value: walkSpeed/1068">walkSpeed</span></span>, <span class="type" data-type="790"><span class="record-value-identifier" data-id="attr: Geom!.vector - theta">theta</span>: <span class="type" data-type="960"><span class="float">0.</span></span>}</span></span></span> <span class="type" data-type="1157"><span class="boolean">:</span></span> <span class="type" data-type="323"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.v0">v0</span></span>)</span> <span class="type" data-type="556"><span class="boolean">:</span></span> <span class="type" data-type="1338"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.v0">v0</span></span>
  )</span></span></span>;
  /* let acc = Geom.scaleVector(acc, timeScale); */
  <span class="type" data-type="784"><span class="type" data-type="106">let <span class="type" data-type="1018">(<span class="type" data-type="553"><span class="declaration-var" data-id="value: isOnGround/1195">isOnGround</span></span>, <span class="type" data-type="1094">(<span class="type" data-type="598"><span class="declaration-var" data-id="value: vel/1196">vel</span></span>, <span class="type" data-type="889"><span class="declaration-var" data-id="value: hits/1197">hits</span></span>)</span>)</span> = <span class="type" data-type="1105"><span class="type" data-type="399"><span class="module-identifier" data-id="module: MovePlayer/1079">MovePlayer</span>.<span class="value-identifier" data-id="value: MovePlayer/1079.moveObject">moveObject</span></span>(
    ~reallyCheckJump=<span class="type" data-type="867"><span class="type" data-type="305"><span class="type" data-type="304"><span class="unit">()</span></span> => <span class="type" data-type="173">{
      <span class="type" data-type="91"><span class="value-identifier" data-id="value: isStationaryStoneBelow/1080">isStationaryStoneBelow</span></span>(<span class="type" data-type="422"><span class="value-identifier" data-id="value: stones/1120">stones</span></span>, <span class="type" data-type="115"><span class="value-identifier" data-id="value: player/1119">player</span></span>)
    }</span></span></span>,
    <span class="type" data-type="1449"><span class="type" data-type="1008"><span class="type" data-type="519"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="775"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>.<span class="type" data-type="862"><span class="field-value-identifier" data-id="attr: Geom!.Rect.t - pos">pos</span></span></span>, <span class="type" data-type="571"><span class="type" data-type="251"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="1208"><span class="field-value-identifier" data-id="attr: Play_types!.player - vel">vel</span></span></span>, <span class="type" data-type="243"><span class="value-identifier" data-id="value: acc/1124">acc</span></span>, <span class="type" data-type="1123"><span class="type" data-type="278"><span class="value-identifier" data-id="value: userInput/1118">userInput</span></span>.<span class="type" data-type="529"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span></span></span>, <span class="type" data-type="838"><span class="type" data-type="374"><span class="module-identifier" data-id="module: Play_collide!">Play_collide</span>.<span class="value-identifier" data-id="value: Play_collide!.testRect">testRect</span></span>(<span class="type" data-type="1311"><span class="type" data-type="1239"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="182"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>)</span>, <span class="type" data-type="1218"><span class="type" data-type="902"><span class="module-identifier" data-id="module: Play_collide!">Play_collide</span>.<span class="value-identifier" data-id="value: Play_collide!.collideRect">collideRect</span></span>(<span class="type" data-type="973"><span class="type" data-type="171"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="817"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>)</span>, <span class="type" data-type="396"><span class="value-identifier" data-id="value: blocks/1121">blocks</span></span>)</span></span>;
  <span class="type" data-type="1280">{...<span class="type" data-type="266"><span class="value-identifier" data-id="value: player/1119">player</span></span>, <span class="type" data-type="1114"><span class="type" data-type="408"><span class="record-value-identifier" data-id="value: vel/1196"><span class="value-identifier" data-id="value: vel/1196">vel</span></span></span>, <span class="type" data-type="248"><span class="record-value-identifier" data-id="attr: Play_types!.player - box">box</span>: <span class="type" data-type="1186"><span class="type" data-type="1103"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.push">push</span></span>(<span class="type" data-type="1385"><span class="type" data-type="129"><span class="value-identifier" data-id="value: player/1119">player</span></span>.<span class="type" data-type="1413"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>, <span class="type" data-type="542"><span class="value-identifier" data-id="value: vel/1196">vel</span></span>)</span>, <span class="type" data-type="1392"><span class="type" data-type="695"><span class="record-value-identifier" data-id="value: isOnGround/1195"><span class="value-identifier" data-id="value: isOnGround/1195">isOnGround</span></span></span>}</span></span></span></span></span></span>
}</span></span></span></span></span></span></span>;

<span class="type" data-type="1484"><span class="string">/** Populate the `userInput` record according to the keyboard state */</span>
let <span class="type" data-type="1368"><span class="declaration-var" data-id="value: getUserInput/1198">getUserInput</span></span> = <span class="type" data-type="288">(<span class="type" data-type="14"><span class="declaration-var" data-id="value: prev/1199">prev</span></span>, <span class="type" data-type="974"><span class="type" data-type="829"><span class="declaration-var" data-id="value: env/1200">env</span></span>) => Reprocessing <span class="open-exposing">exposing (<span class="open-value" data-id="value: Reprocessing!.Env.key">Env.key</span>, <span class="open-type" data-id="type: Reprocessing!.Events.keycodeT">Events.keycodeT</span> (<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - W">W</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - Up">Up</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - S">S</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - Right">Right</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - Left">Left</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - Down">Down</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - D">D</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - C">C</span>|<span class="open-type-constructor" data-id="constr: Reprocessing!.Events.keycodeT - A">A</span>))</span>.<span class="type" data-type="1335">({
  <span class="type" data-type="854"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - left">left</span>: <span class="type" data-type="1137"><span class="type" data-type="1082"><span class="type" data-type="1003"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="128"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Left">Left</span></span>, <span class="type" data-type="539"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span> <span class="type" data-type="1334"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1482"><span class="type" data-type="800"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="199"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - A">A</span></span>, <span class="type" data-type="535"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span></span>,
  <span class="type" data-type="762"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - right">right</span>: <span class="type" data-type="923"><span class="type" data-type="834"><span class="type" data-type="477"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="94"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Right">Right</span></span>, <span class="type" data-type="549"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span> <span class="type" data-type="186"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1445"><span class="type" data-type="1122"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="13"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - D">D</span></span>, <span class="type" data-type="909"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span></span>,
  <span class="type" data-type="1302"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - up">up</span>: <span class="type" data-type="1081"><span class="type" data-type="515"><span class="type" data-type="270"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="1340"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Up">Up</span></span>, <span class="type" data-type="122"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span> <span class="type" data-type="1255"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1306"><span class="type" data-type="1232"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="254"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - W">W</span></span>, <span class="type" data-type="172"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span></span>,
  <span class="type" data-type="1296"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - down">down</span>: <span class="type" data-type="945"><span class="type" data-type="921"><span class="type" data-type="663"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="1002"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Down">Down</span></span>, <span class="type" data-type="303"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span> <span class="type" data-type="551"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1035"><span class="type" data-type="503"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="685"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - S">S</span></span>, <span class="type" data-type="1047"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span></span>,
  <span class="type" data-type="845"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="1017"><span class="type" data-type="980"><span class="type" data-type="753"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="1144"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Up">Up</span></span>, <span class="type" data-type="1032"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span> <span class="type" data-type="906"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1046"><span class="type" data-type="721"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="987"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - W">W</span></span>, <span class="type" data-type="211"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span></span>,
  <span class="type" data-type="1325"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - action">action</span>: <span class="type" data-type="257"><span class="type" data-type="7"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.key">key</span></span>(<span class="type" data-type="1472"><span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - C">C</span></span>, <span class="type" data-type="1291"><span class="value-identifier" data-id="value: env/1200">env</span></span>)</span>,
})</span></span></span></span></span></span></span></span></span></span>;

<span class="type" data-type="1493"><span class="string">/** Populate the `userInput` record based on touch input. */</span>
let <span class="type" data-type="637"><span class="declaration-var" data-id="value: getTouchInput/1201">getTouchInput</span></span> = <span class="type" data-type="1491">(<span class="type" data-type="1354"><span class="declaration-var" data-id="value: state/1202">state</span></span>, <span class="type" data-type="885"><span class="type" data-type="378"><span class="declaration-var" data-id="value: env/1203">env</span></span>) => <span class="type" data-type="189">{
  <span class="type" data-type="1411">let <span class="type" data-type="1279"><span class="declaration-var" data-id="value: throwId/1204">throwId</span></span> = <span class="type" data-type="983">switch <span class="type" data-type="810"><span class="type" data-type="789"><span class="type" data-type="694"><span class="value-identifier" data-id="value: state/1202">state</span></span>.<span class="type" data-type="1259"><span class="field-value-identifier" data-id="attr: Play_types!.state - player">player</span></span></span>.<span class="type" data-type="459"><span class="field-value-identifier" data-id="attr: Play_types!.player - throw">throw</span></span></span> {
  | <span class="type" data-type="1476"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="1190"><span class="constructor-module-identifier" data-id="constr: option/10 - None">None</span></span>
  | <span class="type" data-type="229"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1173">(<span class="type" data-type="976">_</span>, <span class="type" data-type="1380">_</span>, <span class="type" data-type="1021">_</span>, <span class="type" data-type="728"><span class="declaration-var" data-id="value: id/1205">id</span></span>)</span>)</span> => <span class="type" data-type="1038"><span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1463"><span class="value-identifier" data-id="value: id/1205">id</span></span>)</span>
  }</span></span>;
  <span class="type" data-type="616"><span class="type" data-type="54"><span class="module-identifier" data-id="module: Hashtbl!">Hashtbl</span>.<span class="value-identifier" data-id="value: Hashtbl!.fold">fold</span></span>(<span class="type" data-type="268">(<span class="type" data-type="523"><span class="declaration-var" data-id="value: key/1244">key</span></span>, <span class="type" data-type="180"><span class="type" data-type="9"><span class="declaration-var" data-id="value: pos/1245">pos</span></span>, <span class="type" data-type="724"><span class="type" data-type="666"><span class="declaration-var" data-id="value: input/1246">input</span></span>) => <span class="type" data-type="954">{
    if <span class="type" data-type="1200">(<span class="type" data-type="112"><span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1257"><span class="value-identifier" data-id="value: key/1244">key</span></span>)</span> <span class="type" data-type="284">=<span class="operator" data-id="value: Pervasives!.=">=</span></span> <span class="type" data-type="1389"><span class="value-identifier" data-id="value: throwId/1204">throwId</span></span>)</span> <span class="type" data-type="866">{
      <span class="value-identifier" data-id="value: input/1246">input</span> /* skip this one */
    }</span> else <span class="type" data-type="155">{
      switch <span class="type" data-type="662">(<span class="type" data-type="1148"><span class="module-identifier" data-id="module: Play_touch!">Play_touch</span>.<span class="value-identifier" data-id="value: Play_touch!.joystickButton">joystickButton</span></span>(<span class="type" data-type="1132"><span class="type" data-type="292"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.fromTuple">fromTuple</span></span>(<span class="type" data-type="1270"><span class="value-identifier" data-id="value: pos/1245">pos</span></span>)</span>, <span class="type" data-type="803"><span class="value-identifier" data-id="value: env/1203">env</span></span>))</span> {
      | <span class="type" data-type="1146"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="808">`Left</span>)</span> => <span class="type" data-type="98">{...<span class="type" data-type="530"><span class="value-identifier" data-id="value: input/1246">input</span></span>, <span class="type" data-type="262"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - left">left</span>: <span class="type" data-type="62"><span class="boolean">true</span></span>}</span></span>
      | <span class="type" data-type="1111"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="596">`Right</span>)</span> => <span class="type" data-type="1391">{...<span class="type" data-type="1258"><span class="value-identifier" data-id="value: input/1246">input</span></span>, <span class="type" data-type="1245"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - right">right</span>: <span class="type" data-type="731"><span class="boolean">true</span></span>}</span></span>
      | <span class="type" data-type="269"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="855">`Jump</span>)</span> => <span class="type" data-type="1068">{...<span class="type" data-type="206"><span class="value-identifier" data-id="value: input/1246">input</span></span>, <span class="type" data-type="467"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="85"><span class="boolean">true</span></span>}</span></span>
      | <span class="type" data-type="1052"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="783">`JumpLeft</span>)</span> => <span class="type" data-type="518">{...<span class="type" data-type="630"><span class="value-identifier" data-id="value: input/1246">input</span></span>, <span class="type" data-type="497"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="1366"><span class="boolean">true</span></span>, <span class="type" data-type="741"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - left">left</span>: <span class="type" data-type="466"><span class="boolean">true</span></span>}</span></span></span>
      | <span class="type" data-type="1487"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="114">`JumpRight</span>)</span> => <span class="type" data-type="49">{...<span class="type" data-type="1240"><span class="value-identifier" data-id="value: input/1246">input</span></span>, <span class="type" data-type="469"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="1057"><span class="boolean">true</span></span>, <span class="type" data-type="1356"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - right">right</span>: <span class="type" data-type="1395"><span class="boolean">true</span></span>}</span></span></span>
      | <span class="type" data-type="1023">_</span> => <span class="type" data-type="496"><span class="value-identifier" data-id="value: input/1246">input</span></span>
      }
    }</span>
  }</span></span></span></span>, <span class="type" data-type="681"><span class="type" data-type="587"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.touches">touches</span></span>(<span class="type" data-type="357"><span class="value-identifier" data-id="value: env/1203">env</span></span>)</span>, <span class="type" data-type="146">{
    <span class="type" data-type="857"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - left">left</span>: <span class="type" data-type="772"><span class="boolean">false</span></span>, <span class="type" data-type="1244"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - right">right</span>: <span class="type" data-type="939"><span class="boolean">false</span></span>, <span class="type" data-type="1268"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="1"><span class="boolean">false</span></span>, <span class="type" data-type="916"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - action">action</span>: <span class="type" data-type="814"><span class="boolean">false</span></span>, <span class="type" data-type="30"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - up">up</span>: <span class="type" data-type="897"><span class="boolean">false</span></span>, <span class="type" data-type="139"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - down">down</span>: <span class="type" data-type="548"><span class="boolean">false</span></span>
  }</span></span></span></span></span></span></span>)</span>
}</span></span></span></span>;

<span class="type" data-type="311">let <span class="type" data-type="1277"><span class="declaration-var" data-id="value: mergeInputs/1247">mergeInputs</span></span> = <span class="type" data-type="325">(<span class="type" data-type="297"><span class="declaration-var" data-id="value: one/1248">one</span></span>, <span class="type" data-type="494"><span class="type" data-type="411"><span class="declaration-var" data-id="value: two/1249">two</span></span>) => <span class="type" data-type="359">{
  <span class="type" data-type="1205"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - left">left</span>: <span class="type" data-type="1410"><span class="type" data-type="1182"><span class="type" data-type="349"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="460"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span></span> <span class="type" data-type="441"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1009"><span class="type" data-type="335"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="245"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span></span></span>,
  <span class="type" data-type="537"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - right">right</span>: <span class="type" data-type="761"><span class="type" data-type="318"><span class="type" data-type="158"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="185"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span></span> <span class="type" data-type="53"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1374"><span class="type" data-type="188"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="491"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span></span></span>,
  <span class="type" data-type="796"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - up">up</span>: <span class="type" data-type="566"><span class="type" data-type="409"><span class="type" data-type="118"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="1037"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - up">up</span></span></span> <span class="type" data-type="913"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="931"><span class="type" data-type="736"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="878"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - up">up</span></span></span></span>,
  <span class="type" data-type="934"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - down">down</span>: <span class="type" data-type="1235"><span class="type" data-type="1062"><span class="type" data-type="280"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="436"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - down">down</span></span></span> <span class="type" data-type="1286"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="536"><span class="type" data-type="154"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="633"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - down">down</span></span></span></span>,
  <span class="type" data-type="19"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span>: <span class="type" data-type="506"><span class="type" data-type="317"><span class="type" data-type="51"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="937"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span></span></span> <span class="type" data-type="403"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1329"><span class="type" data-type="723"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="893"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - jump">jump</span></span></span></span>,
  <span class="type" data-type="1337"><span class="record-value-identifier" data-id="attr: Play_types!.userInput - action">action</span>: <span class="type" data-type="986"><span class="type" data-type="968"><span class="type" data-type="282"><span class="value-identifier" data-id="value: one/1248">one</span></span>.<span class="type" data-type="670"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - action">action</span></span></span> <span class="type" data-type="849"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1238"><span class="type" data-type="508"><span class="value-identifier" data-id="value: two/1249">two</span></span>.<span class="type" data-type="868"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - action">action</span></span></span></span>
}</span></span></span></span></span></span></span></span></span></span>;

<span class="type" data-type="1330"><span class="string">/** TODO I have no idea how to do this right. */</span>
let <span class="type" data-type="367"><span class="declaration-var" data-id="value: normalFps/1250">normalFps</span></span> = <span class="type" data-type="949"><span class="type" data-type="888"><span class="float">1.</span></span> <span class="type" data-type="263"><span class="operator" data-id="value: Pervasives!./.">/.</span></span> <span class="type" data-type="757"><span class="float">60.</span></span></span></span>;
<span class="type" data-type="1134">let <span class="type" data-type="355"><span class="declaration-var" data-id="value: getTimeScale/1251">getTimeScale</span></span> = <span class="type" data-type="1471"><span class="type" data-type="831"><span class="declaration-var" data-id="value: env/1252">env</span></span> => <span class="type" data-type="948"><span class="type" data-type="704"><span class="type" data-type="366"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.deltaTime">deltaTime</span></span>(<span class="type" data-type="390"><span class="value-identifier" data-id="value: env/1252">env</span></span>)</span> <span class="type" data-type="1405"><span class="operator" data-id="value: Pervasives!./.">/.</span></span> <span class="type" data-type="610"><span class="value-identifier" data-id="value: normalFps/1250">normalFps</span></span></span></span></span>;

<span class="type" data-type="1425"><span class="string">/** Resize the camera if the screen has rotated or been resized */</span>
let <span class="type" data-type="445"><span class="declaration-var" data-id="value: handleResize/1253">handleResize</span></span> = <span class="type" data-type="442">(<span class="type" data-type="1126"><span class="declaration-var" data-id="value: state/1254">state</span></span>, <span class="type" data-type="1263"><span class="type" data-type="511"><span class="declaration-var" data-id="value: env/1255">env</span></span>) => <span class="type" data-type="985">{
    <span class="type" data-type="569">let <span class="type" data-type="901">(<span class="type" data-type="130"><span class="declaration-var" data-id="value: x/1256">x</span></span>, <span class="type" data-type="946"><span class="declaration-var" data-id="value: y/1257">y</span></span>, <span class="type" data-type="852"><span class="declaration-var" data-id="value: w/1258">w</span></span>, <span class="type" data-type="214"><span class="declaration-var" data-id="value: h/1259">h</span></span>)</span> = <span class="type" data-type="1447"><span class="type" data-type="1346"><span class="value-identifier" data-id="value: state/1254">state</span></span>.<span class="type" data-type="821"><span class="field-value-identifier" data-id="attr: Play_types!.state - camera">camera</span></span></span></span>;
    open Reprocessing <span class="open-exposing">exposing (<span class="open-value" data-id="value: Reprocessing!.Env.height">Env.height</span>, <span class="open-value" data-id="value: Reprocessing!.Env.width">Env.width</span>)</span>;
    <span class="type" data-type="606">if <span class="type" data-type="170">(<span class="type" data-type="1423"><span class="type" data-type="940"><span class="type" data-type="882"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.width">width</span></span>(<span class="type" data-type="614"><span class="value-identifier" data-id="value: env/1255">env</span></span>)</span> <span class="type" data-type="1096"><span class="operator" data-id="value: Pervasives!.<>">!=</span></span> <span class="type" data-type="1361"><span class="type" data-type="558"><span class="value-identifier" data-id="value: Pervasives!.int_of_float">int_of_float</span></span>(<span class="type" data-type="234"><span class="value-identifier" data-id="value: w/1258">w</span></span>)</span></span> <span class="type" data-type="984"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1357"><span class="type" data-type="1086"><span class="type" data-type="1016"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.height">height</span></span>(<span class="type" data-type="1215"><span class="value-identifier" data-id="value: env/1255">env</span></span>)</span> <span class="type" data-type="636"><span class="operator" data-id="value: Pervasives!.<>">!=</span></span> <span class="type" data-type="1462"><span class="type" data-type="1101"><span class="value-identifier" data-id="value: Pervasives!.int_of_float">int_of_float</span></span>(<span class="type" data-type="1475"><span class="value-identifier" data-id="value: h/1259">h</span></span>)</span></span>)</span> <span class="type" data-type="795">{
      {...<span class="type" data-type="1394"><span class="value-identifier" data-id="value: state/1254">state</span></span>, <span class="type" data-type="1295"><span class="record-value-identifier" data-id="attr: Play_types!.state - camera">camera</span>: <span class="type" data-type="1384">(<span class="type" data-type="1178"><span class="value-identifier" data-id="value: x/1256">x</span></span>, <span class="type" data-type="879"><span class="value-identifier" data-id="value: y/1257">y</span></span>, <span class="type" data-type="1310"><span class="type" data-type="900"><span class="value-identifier" data-id="value: Pervasives!.float_of_int">float_of_int</span></span>(<span class="type" data-type="484"><span class="type" data-type="2"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.width">width</span></span>(<span class="type" data-type="1323"><span class="value-identifier" data-id="value: env/1255">env</span></span>)</span>)</span>, <span class="type" data-type="1319"><span class="type" data-type="21"><span class="value-identifier" data-id="value: Pervasives!.float_of_int">float_of_int</span></span>(<span class="type" data-type="437"><span class="type" data-type="117"><span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.height">height</span></span>(<span class="type" data-type="804"><span class="value-identifier" data-id="value: env/1255">env</span></span>)</span>)</span>)</span>}
    }</span></span> else <span class="type" data-type="18">{
      <span class="value-identifier" data-id="value: state/1254">state</span>
    }</span></span>
}</span></span></span></span>;

<span class="type" data-type="398"><span class="string">/** Add an item to the inventory.
 *
 * If there's a slot that already has things of this type, then increment that slot. Otherwise find an empty slot.
 */</span>
let <span class="type" data-type="1285"><span class="declaration-var" data-id="value: addToInventory/1260">addToInventory</span></span> = <span class="type" data-type="693">(<span class="type" data-type="802"><span class="declaration-var" data-id="value: inventory/1261">inventory</span></span>, <span class="type" data-type="1071"><span class="type" data-type="1026"><span class="declaration-var" data-id="value: item/1262">item</span></span>, <span class="type" data-type="1020"><span class="type" data-type="192"><span class="declaration-var" data-id="value: n/1263">n</span></span>) => {
  open Inventory <span class="open-exposing">exposing (<span class="open-record" data-id="type: Play_types!.Inventory.t">t</span> {<span class="open-record-attribute" data-id="attr: Play_types!.Inventory.t - slots">slots</span>})</span>;
  <span class="type" data-type="1252">switch <span class="type" data-type="1248">(<span class="type" data-type="979"><span class="value-identifier" data-id="value: Play_types!.find">find</span></span>(<span class="type" data-type="827"><span class="type" data-type="687"><span class="value-identifier" data-id="value: inventory/1261">inventory</span></span>.<span class="type" data-type="1372"><span class="field-value-identifier" data-id="attr: Play_types!.Inventory.t - slots">slots</span></span></span>, <span class="type" data-type="579">(<span class="type" data-type="458">(<span class="type" data-type="977"><span class="declaration-var" data-id="value: x/1266">x</span></span>, <span class="type" data-type="1298">_</span>)</span>) => <span class="type" data-type="848"><span class="type" data-type="308"><span class="value-identifier" data-id="value: x/1266">x</span></span> <span class="type" data-type="1051">=<span class="operator" data-id="value: Pervasives!.=">=</span></span> <span class="type" data-type="1377"><span class="value-identifier" data-id="value: item/1262">item</span></span></span></span>))</span> {
  | <span class="type" data-type="1284"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="847"><span class="declaration-var" data-id="value: i/1267">i</span></span>)</span> => <span class="type" data-type="698">{
    <span class="type" data-type="238">let <span class="type" data-type="1095">(<span class="type" data-type="1474">_</span>, <span class="type" data-type="209"><span class="declaration-var" data-id="value: c/1268">c</span></span>)</span> = <span class="type" data-type="1426"><span class="type" data-type="600"><span class="type" data-type="490"><span class="value-identifier" data-id="value: inventory/1261">inventory</span></span>.<span class="type" data-type="522"><span class="field-value-identifier" data-id="attr: Play_types!.Inventory.t - slots">slots</span></span></span>[<span class="type" data-type="354"><span class="value-identifier" data-id="value: i/1267">i</span></span>]</span></span>;
    <span class="type" data-type="1251"><span class="type" data-type="470"><span class="type" data-type="145"><span class="value-identifier" data-id="value: inventory/1261">inventory</span></span>.<span class="type" data-type="203"><span class="field-value-identifier" data-id="attr: Play_types!.Inventory.t - slots">slots</span></span></span>[<span class="type" data-type="1149"><span class="value-identifier" data-id="value: i/1267">i</span></span>] = <span class="type" data-type="745">(<span class="type" data-type="394"><span class="value-identifier" data-id="value: item/1262">item</span></span>, <span class="type" data-type="1442"><span class="type" data-type="1256"><span class="value-identifier" data-id="value: c/1268">c</span></span> <span class="type" data-type="116"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="1434"><span class="value-identifier" data-id="value: n/1263">n</span></span></span>)</span></span>
  }</span>
  | <span class="type" data-type="1185"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="1044">{
    switch <span class="type" data-type="1089">(<span class="type" data-type="272"><span class="value-identifier" data-id="value: Play_types!.find">find</span></span>(<span class="type" data-type="1481"><span class="type" data-type="1237"><span class="value-identifier" data-id="value: inventory/1261">inventory</span></span>.<span class="type" data-type="1181"><span class="field-value-identifier" data-id="attr: Play_types!.Inventory.t - slots">slots</span></span></span>, <span class="type" data-type="769">(<span class="type" data-type="259">(<span class="type" data-type="1359"><span class="declaration-var" data-id="value: x/1269">x</span></span>, <span class="type" data-type="150">_</span>)</span>) => <span class="type" data-type="1469"><span class="type" data-type="1431"><span class="value-identifier" data-id="value: x/1269">x</span></span> <span class="type" data-type="1440">=<span class="operator" data-id="value: Pervasives!.=">=</span></span> <span class="type" data-type="489"><span class="constructor-module-identifier" data-id="module: Play_types!.Inventory">Inventory</span>.<span class="constructor-module-identifier" data-id="constr: Play_types!.Inventory.item - Nothing">Nothing</span></span></span></span>))</span> {
    | <span class="type" data-type="677"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="1213"><span class="unit">()</span></span>
    | <span class="type" data-type="959"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="851"><span class="declaration-var" data-id="value: i/1270">i</span></span>)</span> => <span class="type" data-type="926">{
      <span class="type" data-type="1225"><span class="type" data-type="1207"><span class="value-identifier" data-id="value: inventory/1261">inventory</span></span>.<span class="type" data-type="435"><span class="field-value-identifier" data-id="attr: Play_types!.Inventory.t - slots">slots</span></span></span>[<span class="type" data-type="93"><span class="value-identifier" data-id="value: i/1270">i</span></span>] = <span class="type" data-type="1031">(<span class="type" data-type="169"><span class="value-identifier" data-id="value: item/1262">item</span></span>, <span class="type" data-type="990"><span class="value-identifier" data-id="value: n/1263">n</span></span>)</span>
    }</span>
    }
  }</span>
  }</span>
}</span></span></span></span>;

<span class="type" data-type="830"><span class="string">/** Get a list of adjacent squares we should hit if we dig.
 *
 * We'll then go through the list in order, looking for a square that's non-empty, and "hit" that block.
 */</span>
let <span class="type" data-type="1418"><span class="declaration-var" data-id="value: positionsToDig/1271">positionsToDig</span></span> = <span class="type" data-type="700">(<span class="type" data-type="502"><span class="declaration-var" data-id="value: player/1272">player</span></span>, <span class="type" data-type="892"><span class="type" data-type="179"><span class="declaration-var" data-id="value: userInput/1273">userInput</span></span>, <span class="type" data-type="1409"><span class="type" data-type="1262"><span class="declaration-var" data-id="value: facingLeft/1274">facingLeft</span></span>) => <span class="type" data-type="593">{
  <span class="type" data-type="1489">let <span class="type" data-type="1467"><span class="declaration-var" data-id="value: pos/1275">pos</span></span> = <span class="type" data-type="952"><span class="type" data-type="652"><span class="type" data-type="482"><span class="value-identifier" data-id="value: player/1272">player</span></span>.<span class="type" data-type="581"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>.<span class="type" data-type="258"><span class="field-module-identifier" data-id="module: Geom!">Geom</span>.<span class="field-module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="field-value-identifier" data-id="attr: Geom!.Rect.t - pos">pos</span></span></span></span>;
  <span class="type" data-type="1034">if <span class="type" data-type="1030">(<span class="type" data-type="142"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="874"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - up">up</span></span>)</span> <span class="type" data-type="76">{
    [<span class="type" data-type="881">(<span class="type" data-type="370"><span class="int">0</span></span>, <span class="type" data-type="1043"><span class="int">-1</span></span>)</span>,
      <span class="type" data-type="654">(<span class="type" data-type="1151"><span class="type" data-type="715"><span class="type" data-type="552"><span class="type" data-type="92"><span class="value-identifier" data-id="value: Pervasives!.mod_float">mod_float</span></span>(<span class="type" data-type="915"><span class="type" data-type="625"><span class="type" data-type="296"><span class="value-identifier" data-id="value: pos/1275">pos</span></span>.<span class="type" data-type="233"><span class="field-module-identifier" data-id="module: Geom!">Geom</span>.<span class="field-value-identifier" data-id="attr: Geom!.point - x">x</span></span></span> <span class="type" data-type="975"><span class="operator" data-id="value: Pervasives!./.">/.</span></span> <span class="type" data-type="36"><span class="value-identifier" data-id="value: Play_types!.blockSize">blockSize</span></span></span>, <span class="type" data-type="1121"><span class="float">1.</span></span>)</span> <span class="type" data-type="72"><span class="operator" data-id="value: Pervasives!.>">></span></span> <span class="type" data-type="1459"><span class="float">0.5</span></span></span> <span class="type" data-type="1059"><span class="boolean">?</span></span> <span class="type" data-type="1479"><span class="int">1</span></span> <span class="type" data-type="1139"><span class="boolean">:</span></span> <span class="type" data-type="735"><span class="int">-1</span></span></span>, <span class="type" data-type="344"><span class="int">-1</span></span><span class="constructor-operator" data-id="constr: list/9 - ::"><span class="constructor-operator" data-id="constr: list/9 - ::">)</span>,</span></span>
    ]
  }</span> else <span class="type" data-type="943">if <span class="type" data-type="450">(<span class="type" data-type="799"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="237"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span>)</span> <span class="type" data-type="434">{
    <span class="type" data-type="1159"><span class="type" data-type="679"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="1398"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - down">down</span></span></span> <span class="type" data-type="603"><span class="boolean">?</span></span> <span class="type" data-type="1313">[<span class="type" data-type="322">(<span class="type" data-type="17"><span class="int">-1</span></span>, <span class="type" data-type="971"><span class="int"><span class="constructor-operator" data-id="constr: list/9 - ::">0</span></span>)</span></span>]</span> <span class="type" data-type="1161"><span class="boolean">:</span></span> <span class="type" data-type="592">[<span class="type" data-type="1383">(<span class="type" data-type="121"><span class="int">-1</span></span>, <span class="type" data-type="958"><span class="int">-1</span></span>)</span>, <span class="type" data-type="780">(<span class="type" data-type="1403"><span class="int">-1</span></span>, <span class="type" data-type="1308"><span class="int"><span class="constructor-operator" data-id="constr: list/9 - ::"><span class="constructor-operator" data-id="constr: list/9 - ::">0</span></span>)</span></span></span>]</span>
  }</span> else <span class="type" data-type="1243">if <span class="type" data-type="334">(<span class="type" data-type="512"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="565"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span>)</span> <span class="type" data-type="1025">{
    <span class="type" data-type="1172"><span class="type" data-type="766"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="574"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - down">down</span></span></span> <span class="type" data-type="236"><span class="boolean">?</span></span> <span class="type" data-type="759">[<span class="type" data-type="894">(<span class="type" data-type="1168"><span class="int">1</span></span>, <span class="type" data-type="69"><span class="int"><span class="constructor-operator" data-id="constr: list/9 - ::">0</span></span>)</span></span>]</span> <span class="type" data-type="1011"><span class="boolean">:</span></span> <span class="type" data-type="271">[<span class="type" data-type="656">(<span class="type" data-type="1436"><span class="int">1</span></span>, <span class="type" data-type="1318"><span class="int">-1</span></span>)</span>, <span class="type" data-type="935">(<span class="type" data-type="50"><span class="int">1</span></span>, <span class="type" data-type="651"><span class="int"><span class="constructor-operator" data-id="constr: list/9 - ::"><span class="constructor-operator" data-id="constr: list/9 - ::">0</span></span>)</span></span></span>]</span>
  }</span> else <span class="type" data-type="424">if <span class="type" data-type="1124">(<span class="type" data-type="1024"><span class="value-identifier" data-id="value: userInput/1273">userInput</span></span>.<span class="type" data-type="1110"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - down">down</span></span>)</span> <span class="type" data-type="1458">{
    [
      <span class="type" data-type="127">(<span class="type" data-type="1193"><span class="int">0</span></span>, <span class="type" data-type="61"><span class="int">1</span></span>)</span>,
      <span class="type" data-type="1461">(<span class="type" data-type="1136"><span class="type" data-type="925"><span class="type" data-type="88"><span class="type" data-type="77"><span class="value-identifier" data-id="value: Pervasives!.mod_float">mod_float</span></span>(<span class="type" data-type="1379"><span class="type" data-type="451"><span class="type" data-type="417"><span class="value-identifier" data-id="value: pos/1275">pos</span></span>.<span class="type" data-type="1261"><span class="field-module-identifier" data-id="module: Geom!">Geom</span>.<span class="field-value-identifier" data-id="attr: Geom!.point - x">x</span></span></span> <span class="type" data-type="353"><span class="operator" data-id="value: Pervasives!./.">/.</span></span> <span class="type" data-type="1165"><span class="value-identifier" data-id="value: Play_types!.blockSize">blockSize</span></span></span>, <span class="type" data-type="1360"><span class="float">1.</span></span>)</span> <span class="type" data-type="101"><span class="operator" data-id="value: Pervasives!.>">></span></span> <span class="type" data-type="413"><span class="float">0.5</span></span></span> <span class="type" data-type="604"><span class="boolean">?</span></span> <span class="type" data-type="1290"><span class="int">1</span></span> <span class="type" data-type="342"><span class="boolean">:</span></span> <span class="type" data-type="429"><span class="int">-1</span></span></span>, <span class="type" data-type="564"><span class="int">1</span></span><span class="constructor-operator" data-id="constr: list/9 - ::"><span class="constructor-operator" data-id="constr: list/9 - ::">)</span>,</span></span>
    ];
  }</span> else <span class="type" data-type="676">{
    [<span class="type" data-type="965">(<span class="type" data-type="314"><span class="type" data-type="24"><span class="value-identifier" data-id="value: facingLeft/1274">facingLeft</span></span> <span class="type" data-type="1490"><span class="boolean">?</span></span> <span class="type" data-type="1283"><span class="int">-1</span></span> <span class="type" data-type="363"><span class="boolean">:</span></span> <span class="type" data-type="1322"><span class="int">1</span></span></span>, <span class="type" data-type="41"><span class="int">-1</span></span>)</span>, <span class="type" data-type="402">(<span class="type" data-type="730"><span class="type" data-type="316"><span class="value-identifier" data-id="value: facingLeft/1274">facingLeft</span></span> <span class="type" data-type="23"><span class="boolean">?</span></span> <span class="type" data-type="690"><span class="int">-1</span></span> <span class="type" data-type="1349"><span class="boolean">:</span></span> <span class="type" data-type="95"><span class="int">1</span></span></span>, <span class="type" data-type="1152"><span class="int"><span class="constructor-operator" data-id="constr: list/9 - ::"><span class="constructor-operator" data-id="constr: list/9 - ::">0</span></span>)</span></span></span>]
  }</span></span></span></span>;</span>
}</span></span></span></span></span>;

<span class="type" data-type="276"><span class="string">/** Damage a `Block.t`, removing it if the damage exceeds `1.` */</span>
let <span class="type" data-type="369"><span class="declaration-var" data-id="value: attack/1276">attack</span></span> = <span class="type" data-type="217">(<span class="type" data-type="393"><span class="declaration-var" data-id="value: state/1277">state</span></span>, <span class="type" data-type="1077"><span class="type" data-type="602"><span class="declaration-var" data-id="value: player/1278">player</span></span>, <span class="type" data-type="1061"><span class="type" data-type="771"><span class="declaration-var" data-id="value: block/1279">block</span></span>, <span class="type" data-type="377"><span class="type" data-type="331"><span class="declaration-var" data-id="value: x/1280">x</span></span>, <span class="type" data-type="1204"><span class="type" data-type="1198"><span class="declaration-var" data-id="value: y/1281">y</span></span>) => {
  open Block <span class="open-exposing">exposing (<span class="open-record" data-id="type: Play_types!.Block.t">t</span> {<span class="open-record-attribute" data-id="attr: Play_types!.Block.t - damage">damage</span>})</span>;
  <span class="type" data-type="1254"><span class="type" data-type="752">let <span class="type" data-type="87"><span class="declaration-var" data-id="value: x/1285">x</span></span> = <span class="type" data-type="105"><span class="type" data-type="68"><span class="value-identifier" data-id="value: Play_types!.loopx">loopx</span></span>(<span class="type" data-type="1278"><span class="type" data-type="240"><span class="value-identifier" data-id="value: state/1277">state</span></span>.<span class="type" data-type="109"><span class="field-value-identifier" data-id="attr: Play_types!.state - blocks">blocks</span></span></span>, <span class="type" data-type="707"><span class="value-identifier" data-id="value: x/1280">x</span></span>)</span></span>;
  <span class="type" data-type="205"><span class="type" data-type="202">let <span class="type" data-type="329"><span class="declaration-var" data-id="value: damage/1286">damage</span></span> = <span class="type" data-type="178"><span class="float">0.35</span></span></span>;
  <span class="type" data-type="1250"><span class="type" data-type="1099"><span class="type" data-type="957"><span class="type" data-type="527"><span class="value-identifier" data-id="value: state/1277">state</span></span>.<span class="type" data-type="1188"><span class="field-value-identifier" data-id="attr: Play_types!.state - blocks">blocks</span></span></span>[<span class="type" data-type="368"><span class="value-identifier" data-id="value: y/1281">y</span></span>]</span>[<span class="type" data-type="1070"><span class="value-identifier" data-id="value: x/1285">x</span></span>] =
  <span class="type" data-type="1080">if <span class="type" data-type="749">(<span class="type" data-type="1336"><span class="type" data-type="387"><span class="type" data-type="208"><span class="value-identifier" data-id="value: block/1279">block</span></span>.<span class="type" data-type="384"><span class="field-value-identifier" data-id="attr: Play_types!.Block.t - damage">damage</span></span></span> <span class="type" data-type="645"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="1260"><span class="value-identifier" data-id="value: damage/1286">damage</span></span></span> <span class="type" data-type="689"><span class="operator" data-id="value: Pervasives!.>=">>=</span></span> <span class="type" data-type="1294"><span class="float">1.</span></span>)</span> <span class="type" data-type="453">{
    <span class="type" data-type="493">if <span class="type" data-type="692">(<span class="type" data-type="727"><span class="type" data-type="717"><span class="value-identifier" data-id="value: block/1279">block</span></span>.<span class="type" data-type="778"><span class="field-module-identifier" data-id="module: Play_types!.Block">Block</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Block.t - kind">kind</span></span></span> <span class="type" data-type="327">=<span class="operator" data-id="value: Pervasives!.==">==</span></span> <span class="type" data-type="65"><span class="constructor-module-identifier" data-id="module: Play_types!.Block">Block</span>.<span class="constructor-module-identifier" data-id="constr: Play_types!.Block.blockKind - Rock">Rock</span></span>)</span> <span class="type" data-type="525">{
      <span class="type" data-type="634"><span class="value-identifier" data-id="value: addToInventory/1260">addToInventory</span></span>(<span class="type" data-type="861"><span class="type" data-type="476"><span class="value-identifier" data-id="value: player/1278">player</span></span>.<span class="type" data-type="514"><span class="field-value-identifier" data-id="attr: Play_types!.player - inventory">inventory</span></span></span>, <span class="type" data-type="675"><span class="constructor-module-identifier" data-id="module: Play_types!.Inventory">Inventory</span>.<span class="constructor-module-identifier" data-id="constr: Play_types!.Inventory.item - Stone">Stone</span></span>, <span class="type" data-type="956"><span class="type" data-type="886"><span class="int">2</span></span> <span class="type" data-type="12"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="1450"><span class="type" data-type="1274"><span class="module-identifier" data-id="module: Random!">Random</span>.<span class="value-identifier" data-id="value: Random!.int">int</span></span>(<span class="type" data-type="642"><span class="int">3</span></span>)</span></span>)
    }</span></span>;
    <span class="type" data-type="1092"><span class="constructor-module-identifier" data-id="constr: option/10 - None">None</span></span>
  }</span> else <span class="type" data-type="1091">{
    <span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1332">{
      ...<span class="type" data-type="1402"><span class="value-identifier" data-id="value: block/1279">block</span></span>,
      <span class="type" data-type="1444"><span class="record-value-identifier" data-id="attr: Play_types!.Block.t - damage">damage</span>: <span class="type" data-type="813"><span class="type" data-type="737"><span class="type" data-type="149"><span class="value-identifier" data-id="value: block/1279">block</span></span>.<span class="type" data-type="1327"><span class="field-value-identifier" data-id="attr: Play_types!.Block.t - damage">damage</span></span></span> <span class="type" data-type="37"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="373"><span class="value-identifier" data-id="value: damage/1286">damage</span></span></span>
    }</span></span>)
  }</span></span></span></span></span>
}</span></span></span></span></span></span>;

<span class="type" data-type="48"><span class="string">/** Handles the digging action. */</span>
let <span class="type" data-type="1147"><span class="declaration-var" data-id="value: dig/1287">dig</span></span> = <span class="type" data-type="639">(<span class="type" data-type="1067"><span class="declaration-var" data-id="value: state/1288">state</span></span>, <span class="type" data-type="826"><span class="type" data-type="44"><span class="declaration-var" data-id="value: player/1289">player</span></span>, <span class="type" data-type="347"><span class="type" data-type="8"><span class="declaration-var" data-id="value: userInput/1290">userInput</span></span>, <span class="type" data-type="953"><span class="type" data-type="500"><span class="declaration-var" data-id="value: facingLeft/1291">facingLeft</span></span>, <span class="type" data-type="1300"><span class="type" data-type="798"><span class="declaration-var" data-id="value: env/1292">env</span></span>) => <span class="type" data-type="452">{
  if<span class="operator" data-id="value: Pervasives!.not"> <span class="type" data-type="163">(<span class="type" data-type="480"><span class="type" data-type="162">!</span></span><span class="type" data-type="1211"><span class="type" data-type="782"><span class="value-identifier" data-id="value: userInput/1290">userInput</span></span>.<span class="type" data-type="779"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - action">action</span></span></span></span> <span class="type" data-type="1167"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="1301"><span class="type" data-type="449"><span class="type" data-type="10"><span class="value-identifier" data-id="value: player/1289">player</span></span>.<span class="type" data-type="1299"><span class="field-value-identifier" data-id="attr: Play_types!.player - throw">throw</span></span></span> <span class="type" data-type="765">!<span class="operator" data-id="value: Pervasives!.!=">==</span></span> <span class="type" data-type="462"><span class="constructor-module-identifier" data-id="constr: option/10 - None">None</span></span></span>)</span> <span class="type" data-type="638">{
    <span class="value-identifier" data-id="value: player/1289">player</span>
  }</span> else <span class="type" data-type="589">{
    <span class="type" data-type="1189">let <span class="type" data-type="1206">(<span class="type" data-type="1421"><span class="declaration-var" data-id="value: actionTimer/1293">actionTimer</span></span>, <span class="type" data-type="333"><span class="declaration-var" data-id="value: looped/1294">looped</span></span>)</span> = <span class="type" data-type="1115"><span class="type" data-type="629"><span class="module-identifier" data-id="module: Timer!">Timer</span>.<span class="value-identifier" data-id="value: Timer!.incLoop">incLoop</span></span>(<span class="type" data-type="1107"><span class="type" data-type="877"><span class="value-identifier" data-id="value: player/1289">player</span></span>.<span class="type" data-type="706"><span class="field-value-identifier" data-id="attr: Play_types!.player - actionTimer">actionTimer</span></span></span>, <span class="type" data-type="1156"><span class="value-identifier" data-id="value: env/1292">env</span></span>)</span></span>;
    <span class="type" data-type="1353"><span class="type" data-type="871">if <span class="type" data-type="1231">(<span class="value-identifier" data-id="value: looped/1294">looped</span>)</span> <span class="type" data-type="1289">{
      <span class="type" data-type="843">let <span class="type" data-type="426"><span class="declaration-var" data-id="value: pos/1295">pos</span></span> = <span class="type" data-type="1430"><span class="type" data-type="924"><span class="type" data-type="220"><span class="value-identifier" data-id="value: player/1289">player</span></span>.<span class="type" data-type="1222"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>.<span class="type" data-type="1253"><span class="field-module-identifier" data-id="module: Geom!">Geom</span>.<span class="field-module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="field-value-identifier" data-id="attr: Geom!.Rect.t - pos">pos</span></span></span></span>;
      <span class="type" data-type="1433"><span class="type" data-type="919">let <span class="type" data-type="1477">(<span class="type" data-type="177"><span class="declaration-var" data-id="value: x/1296">x</span></span>, <span class="type" data-type="1466"><span class="declaration-var" data-id="value: y/1297">y</span></span>)</span> = <span class="type" data-type="1378"><span class="type" data-type="613"><span class="value-identifier" data-id="value: Play_types!.blockPos">blockPos</span></span>(<span class="type" data-type="884"><span class="value-identifier" data-id="value: pos/1295">pos</span></span>)</span></span>;
      <span class="type" data-type="1393"><span class="type" data-type="812">let <span class="type" data-type="863"><span class="declaration-var" data-id="value: positionsToCheck/1298">positionsToCheck</span></span> = <span class="type" data-type="1143"><span class="type" data-type="534"><span class="value-identifier" data-id="value: positionsToDig/1271">positionsToDig</span></span>(<span class="type" data-type="1117"><span class="value-identifier" data-id="value: player/1289">player</span></span>, <span class="type" data-type="756"><span class="value-identifier" data-id="value: userInput/1290">userInput</span></span>, <span class="type" data-type="1069"><span class="value-identifier" data-id="value: facingLeft/1291">facingLeft</span></span>)</span></span>;
      <span class="type" data-type="1162"><span class="type" data-type="356">let <span class="type" data-type="653"><span class="declaration-var" data-id="value: attack/1299">attack</span></span> = <span class="type" data-type="1388"><span class="type" data-type="805"><span class="value-identifier" data-id="value: attack/1276">attack</span></span>(<span class="type" data-type="1195"><span class="value-identifier" data-id="value: state/1288">state</span></span>, <span class="type" data-type="691"><span class="value-identifier" data-id="value: player/1289">player</span></span>)</span></span>;
      <span class="type" data-type="448"><span class="type" data-type="126">let rec <span class="type" data-type="439"><span class="declaration-var" data-id="value: loop/1300">loop</span></span> = <span class="type" data-type="859">(<span class="type" data-type="1064"><span class="declaration-var" data-id="value: positions/1301">positions</span></span>) => <span class="type" data-type="483">switch <span class="type" data-type="59"><span class="value-identifier" data-id="value: positions/1301">positions</span></span> {
      | <span class="type" data-type="389"><span class="switch-operator" data-id="constr: list/9 - []">[]</span></span> => <span class="type" data-type="1029"><span class="unit">()</span></span>
      | <span class="type" data-type="1317">[<span class="type" data-type="1333">(<span class="type" data-type="1406"><span class="declaration-var" data-id="value: dx/1302">dx</span></span>, <span class="type" data-type="29"><span class="declaration-var" data-id="value: dy/1303">dy</span></span>)</span>, ...<span class="type" data-type="744"><span class="declaration-var" data-id="value: rest/1304">re<span class="switch-operator" data-id="constr: list/9 - ::">st</span></span></span>]</span> => <span class="type" data-type="84">switch <span class="type" data-type="148">(<span class="type" data-type="405"><span class="value-identifier" data-id="value: Play_types!.getBlock">getBlock</span></span>(<span class="type" data-type="568"><span class="type" data-type="509"><span class="value-identifier" data-id="value: state/1288">state</span></span>.<span class="type" data-type="1171"><span class="field-value-identifier" data-id="attr: Play_types!.state - blocks">blocks</span></span></span>, <span class="type" data-type="1040">(<span class="type" data-type="1417"><span class="type" data-type="1381"><span class="value-identifier" data-id="value: x/1296">x</span></span> <span class="type" data-type="699"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="605"><span class="value-identifier" data-id="value: dx/1302">dx</span></span></span>, <span class="type" data-type="135"><span class="type" data-type="28"><span class="value-identifier" data-id="value: y/1297">y</span></span> <span class="type" data-type="631"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="0"><span class="value-identifier" data-id="value: dy/1303">dy</span></span></span>)</span>))</span> {
      | <span class="type" data-type="191"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="559"><span class="type" data-type="138"><span class="value-identifier" data-id="value: loop/1300">loop</span></span>(<span class="type" data-type="1180"><span class="value-identifier" data-id="value: rest/1304">rest</span></span>)</span>
      | <span class="type" data-type="543"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="184"><span class="declaration-var" data-id="value: block/1305">block</span></span>)</span> => <span class="type" data-type="1214"><span class="type" data-type="274"><span class="value-identifier" data-id="value: attack/1299">attack</span></span>(<span class="type" data-type="1125"><span class="value-identifier" data-id="value: block/1305">block</span></span>, <span class="type" data-type="751"><span class="type" data-type="253"><span class="value-identifier" data-id="value: x/1296">x</span></span> <span class="type" data-type="250"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="917"><span class="value-identifier" data-id="value: dx/1302">dx</span></span></span>, <span class="type" data-type="376"><span class="type" data-type="35"><span class="value-identifier" data-id="value: y/1297">y</span></span> <span class="type" data-type="120"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="1282"><span class="value-identifier" data-id="value: dy/1303">dy</span></span></span>)</span>
      }</span>
      }</span></span></span>;
      <span class="type" data-type="1007"><span class="type" data-type="265"><span class="value-identifier" data-id="value: loop/1300">loop</span></span>(<span class="type" data-type="1006"><span class="value-identifier" data-id="value: positionsToCheck/1298">positionsToCheck</span></span>)</span></span></span></span></span>
    }</span></span>;
    <span class="type" data-type="781">{...<span class="type" data-type="858"><span class="value-identifier" data-id="value: player/1289">player</span></span>, <span class="type" data-type="1203"><span class="type" data-type="1022"><span class="record-value-identifier" data-id="value: actionTimer/1293"><span class="value-identifier" data-id="value: actionTimer/1293">actionTimer</span></span></span>}</span></span></span>
  }</span>
}</span></span></span></span></span></span></span>;

<span class="type" data-type="232">let <span class="type" data-type="301"><span class="declaration-var" data-id="value: collideStonesWithPlayer/1306">collideStonesWithPlayer</span></span> = <span class="type" data-type="239">(<span class="type" data-type="703"><span class="declaration-var" data-id="value: stones/1307">stones</span></span>, <span class="type" data-type="1448"><span class="type" data-type="242"><span class="declaration-var" data-id="value: player/1308">player</span></span>) => <span class="type" data-type="74">{
  <span class="type" data-type="599"><span class="module-identifier" data-id="module: List!">List</span>.<span class="value-identifier" data-id="value: List!.fold_left">fold_left</span></span>(
    <span class="type" data-type="1454">(<span class="type" data-type="1439">(<span class="type" data-type="1197"><span class="declaration-var" data-id="value: stones/1309">stones</span></span>, <span class="type" data-type="837"><span class="declaration-var" data-id="value: player/1310">player</span></span>)</span>, <span class="type" data-type="1174"><span class="type" data-type="547"><span class="declaration-var" data-id="value: stone/1311">stone</span></span>) => <span class="type" data-type="1098">{
      if <span class="type" data-type="619">(<span class="type" data-type="1129"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.testCircle">testCircle</span></span>(<span class="type" data-type="1131"><span class="type" data-type="684"><span class="value-identifier" data-id="value: player/1310">player</span></span>.<span class="type" data-type="341"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>, <span class="type" data-type="725"><span class="type" data-type="216"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="1416"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>))</span> <span class="type" data-type="1451">{
        if <span class="type" data-type="942">(<span class="type" data-type="306"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="774"><span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - live">live</span></span>)</span> <span class="type" data-type="358">{
          <span class="type" data-type="144">let <span class="type" data-type="147"><span class="declaration-var" data-id="value: vel/1312">vel</span></span> = <span class="type" data-type="933"><span class="type" data-type="764"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.addVectors">addVectors</span></span>(<span class="type" data-type="1441"><span class="type" data-type="641"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="1010"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - vel">vel</span></span></span>, <span class="type" data-type="767"><span class="type" data-type="555"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.invertVector">invertVector</span></span>(<span class="type" data-type="622"><span class="type" data-type="501"><span class="value-identifier" data-id="value: player/1310">player</span></span>.<span class="type" data-type="81"><span class="field-value-identifier" data-id="attr: Play_types!.player - vel">vel</span></span></span>)</span>)</span></span>;

          /* let v = Geom.Aabb.collideToCircle(vel, Geom.Rect.aabb(player.box), stone.Stone.circle); */

          <span class="type" data-type="1108"><span class="type" data-type="1102">let <span class="type" data-type="499"><span class="declaration-var" data-id="value: v/1313">v</span></span> = <span class="type" data-type="1055"><span class="type" data-type="468"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Aabb">Aabb</span>.<span class="value-identifier" data-id="value: Geom!.Aabb.vectorToCircle">vectorToCircle</span></span>(<span class="type" data-type="1141"><span class="type" data-type="930"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.aabb">aabb</span></span>(<span class="type" data-type="1234"><span class="type" data-type="277"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="module-identifier" data-id="module: Geom!.Rect">Rect</span>.<span class="value-identifier" data-id="value: Geom!.Rect.push">push</span></span>( <span class="type" data-type="726"><span class="type" data-type="401"><span class="value-identifier" data-id="value: player/1310">player</span></span>.<span class="type" data-type="611"><span class="field-value-identifier" data-id="attr: Play_types!.player - box">box</span></span></span>, <span class="type" data-type="1465"><span class="type" data-type="1183"><span class="value-identifier" data-id="value: player/1310">player</span></span>.<span class="type" data-type="816"><span class="field-value-identifier" data-id="attr: Play_types!.player - vel">vel</span></span></span>)</span>)</span>, <span class="type" data-type="1387"><span class="type" data-type="231"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="899"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>)</span></span>;
          <span class="type" data-type="1224"><span class="type" data-type="380">let <span class="type" data-type="1407"><span class="declaration-var" data-id="value: playerRad/1328">playerRad</span></span> = <span class="type" data-type="421"><span class="float">20.</span></span></span>;

          <span class="type" data-type="1027"><span class="type" data-type="818">let <span class="type" data-type="1321"><span class="declaration-var" data-id="value: v/1329">v</span></span> = <span class="type" data-type="770"><span class="type" data-type="196"><span class="value-identifier" data-id="value: v/1313">v</span></span> <span class="type" data-type="688"><span class="operator" data-id="value: Pervasives!.|>">|></span></span> <span class="type" data-type="1056"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.invertVector">invertVector</span></span></span></span>;
          <span class="type" data-type="516"><span class="type" data-type="168">let <span class="type" data-type="79"><span class="declaration-var" data-id="value: first/1330">first</span></span> = <span class="type" data-type="219"><span class="float">400.</span></span></span>;
          <span class="type" data-type="521"><span class="type" data-type="461">let <span class="type" data-type="194"><span class="declaration-var" data-id="value: second/1331">second</span></span> = <span class="type" data-type="4">(<span class="type" data-type="1271"><span class="type" data-type="1249"><span class="type" data-type="388"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="16"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>.<span class="type" data-type="275"><span class="field-value-identifier" data-id="attr: Geom!.Circle.t - rad">rad</span></span></span> <span class="type" data-type="869"><span class="operator" data-id="value: Pervasives!.*.">*.</span></span> <span class="type" data-type="1344"><span class="type" data-type="1155"><span class="type" data-type="60"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="252"><span class="field-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span></span></span>.<span class="type" data-type="1276"><span class="field-value-identifier" data-id="attr: Geom!.Circle.t - rad">rad</span></span></span>)</span></span>;
          <span class="type" data-type="226"><span class="type" data-type="124">let <span class="type" data-type="1369"><span class="declaration-var" data-id="value: fshare/1332">fshare</span></span> = <span class="type" data-type="222"><span class="type" data-type="165"><span class="value-identifier" data-id="value: first/1330">first</span></span> <span class="type" data-type="763"><span class="operator" data-id="value: Pervasives!./.">/.</span></span> <span class="type" data-type="201">(<span class="type" data-type="161"><span class="value-identifier" data-id="value: first/1330">first</span></span> <span class="type" data-type="1304"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="340"><span class="value-identifier" data-id="value: second/1331">second</span></span>)</span></span></span>;

          <span class="type" data-type="989"><span class="type" data-type="573">let <span class="type" data-type="321"><span class="declaration-var" data-id="value: stone/1333">stone</span></span> = <span class="type" data-type="1128"><span class="type" data-type="659"><span class="module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="value-identifier" data-id="value: Play_types!.Stone.force">force</span></span>(<span class="type" data-type="644"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>, <span class="type" data-type="1154"><span class="type" data-type="912"><span class="type" data-type="324"><span class="value-identifier" data-id="value: v/1329">v</span></span> <span class="type" data-type="1119"><span class="operator" data-id="value: Pervasives!.|>">|></span></span> <span class="type" data-type="1166"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.invertVector">invertVector</span></span></span> <span class="type" data-type="966"><span class="operator" data-id="value: Pervasives!.|>">|></span></span> <span class="type" data-type="1371"><span class="type" data-type="15"><span class="declaration-var" data-id="value: x/1334">x</span></span> => <span class="type" data-type="1060"><span class="type" data-type="153"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.scaleVector">scaleVector</span></span>(<span class="type" data-type="1415"><span class="value-identifier" data-id="value: x/1334">x</span></span>, <span class="type" data-type="588"><span class="type" data-type="221"><span class="float">1.</span></span> <span class="type" data-type="176"><span class="operator" data-id="value: Pervasives!.-.">-.</span></span> <span class="type" data-type="1266"><span class="value-identifier" data-id="value: fshare/1332">fshare</span></span></span>)</span></span></span>)</span></span>;
          <span class="type" data-type="993"><span class="type" data-type="395">let <span class="type" data-type="1343"><span class="declaration-var" data-id="value: player/1335">player</span></span> = <span class="type" data-type="332"><span class="type" data-type="83"><span class="module-identifier" data-id="module: Play_types!.Player">Player</span>.<span class="value-identifier" data-id="value: Play_types!.Player.force">force</span></span>(<span class="type" data-type="1273"><span class="value-identifier" data-id="value: player/1310">player</span></span>, <span class="type" data-type="1370"><span class="type" data-type="992"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.scaleVector">scaleVector</span></span>(<span class="type" data-type="788"><span class="value-identifier" data-id="value: v/1329">v</span></span>, <span class="type" data-type="1164"><span class="value-identifier" data-id="value: fshare/1332">fshare</span></span>)</span>)</span></span>;

          <span class="type" data-type="1486">(<span class="type" data-type="175">[<span class="type" data-type="811"><span class="value-identifier" data-id="value: stone/1333">stone</span></span>, ...<span class="type" data-type="898"><span class="value-identifier" data-id="value: stones/1309">ston<span class="constructor-operator" data-id="constr: list/9 - ::">es</span></span></span>]</span>, <span class="type" data-type="1452"><span class="value-identifier" data-id="value: player/1335">player</span></span>)</span></span></span></span></span></span></span></span></span>
        }</span> else <span class="type" data-type="667">{
          (<span class="type" data-type="1412">[<span class="type" data-type="195"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>, ...<span class="type" data-type="577"><span class="value-identifier" data-id="value: stones/1309">ston<span class="constructor-operator" data-id="constr: list/9 - ::">es</span></span></span>]</span>, <span class="type" data-type="1438"><span class="value-identifier" data-id="value: player/1310">player</span></span>)
        }</span>
      }</span> else <span class="type" data-type="57">{
        (<span class="type" data-type="1247">[<span class="type" data-type="951"><span class="type" data-type="595"><span class="type" data-type="346"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>.<span class="type" data-type="479"><span class="field-value-identifier" data-id="attr: Play_types!.Stone.t - live">live</span></span></span> <span class="type" data-type="1355"><span class="boolean">?</span></span> <span class="type" data-type="474"><span class="value-identifier" data-id="value: stone/1311">stone</span></span> <span class="type" data-type="1352"><span class="boolean">:</span></span> <span class="type" data-type="256">{...<span class="type" data-type="26"><span class="value-identifier" data-id="value: stone/1311">stone</span></span>, <span class="type" data-type="705"><span class="record-value-identifier" data-id="attr: Play_types!.Stone.t - live">live</span>: <span class="type" data-type="249"><span class="boolean">true</span></span>}</span></span></span>, ...<span class="type" data-type="1199"><span class="value-identifier" data-id="value: stones/1309">ston<span class="constructor-operator" data-id="constr: list/9 - ::">es</span></span></span>]</span>, <span class="type" data-type="591"><span class="value-identifier" data-id="value: player/1310">player</span></span>)
      }</span>
    }</span></span></span>,
    <span class="type" data-type="1233">(<span class="type" data-type="1281"><span class="constructor-operator" data-id="constr: list/9 - []">[]</span></span>, <span class="type" data-type="1367"><span class="value-identifier" data-id="value: player/1308">player</span></span>)</span>,
    <span class="type" data-type="1457"><span class="value-identifier" data-id="value: stones/1307">stones</span></span>
  )
}</span></span></span></span>;

<span class="type" data-type="505"><span class="string">/** This is the gameloop! Handles player movement & stones movement, which is all we have so far. */</span>
let <span class="type" data-type="485"><span class="declaration-var" data-id="value: step/1336">step</span></span> = <span class="type" data-type="809">(<span class="type" data-type="607"><span class="declaration-var" data-id="value: state/1337">state</span></span>, <span class="type" data-type="1120"><span class="type" data-type="561"><span class="declaration-var" data-id="value: context/1338">context</span></span>, <span class="type" data-type="820"><span class="type" data-type="794"><span class="declaration-var" data-id="value: env/1339">env</span></span>) => <span class="type" data-type="758">{
  <span class="type" data-type="905">let <span class="type" data-type="1414"><span class="declaration-var" data-id="value: state/1340">state</span></span> = <span class="type" data-type="1127"><span class="type" data-type="1063"><span class="value-identifier" data-id="value: handleResize/1253">handleResize</span></span>(<span class="type" data-type="1453"><span class="value-identifier" data-id="value: state/1337">state</span></span>, <span class="type" data-type="1221"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span></span>;

  <span class="type" data-type="1456"><span class="type" data-type="743">let <span class="type" data-type="1163"><span class="declaration-var" data-id="value: timeScale/1341">timeScale</span></span> = <span class="type" data-type="972"><span class="type" data-type="361"><span class="value-identifier" data-id="value: getTimeScale/1251">getTimeScale</span></span>(<span class="type" data-type="198"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span></span>;
  <span class="type" data-type="938"><span class="type" data-type="6">let <span class="type" data-type="447"><span class="declaration-var" data-id="value: userInput/1342">userInput</span></span> = <span class="type" data-type="431"><span class="type" data-type="299"><span class="value-identifier" data-id="value: getUserInput/1198">getUserInput</span></span>(<span class="type" data-type="1073"><span class="type" data-type="750"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="1483"><span class="field-value-identifier" data-id="attr: Play_types!.state - userInput">userInput</span></span></span>, <span class="type" data-type="746"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span></span>;
  <span class="type" data-type="1488"><span class="type" data-type="473">let <span class="type" data-type="67"><span class="declaration-var" data-id="value: userInput/1343">userInput</span></span> = <span class="type" data-type="550">if <span class="type" data-type="1088">(<span class="type" data-type="911"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.isTouchScreen">isTouchScreen</span></span>(<span class="type" data-type="73"><span class="value-identifier" data-id="value: env/1339">env</span></span>))</span> <span class="type" data-type="365">{
    <span class="type" data-type="420"><span class="value-identifier" data-id="value: mergeInputs/1247">mergeInputs</span></span>(<span class="type" data-type="970"><span class="value-identifier" data-id="value: userInput/1342">userInput</span></span>, <span class="type" data-type="1326"><span class="type" data-type="962"><span class="value-identifier" data-id="value: getTouchInput/1201">getTouchInput</span></span>(<span class="type" data-type="1404"><span class="value-identifier" data-id="value: state/1340">state</span></span>, <span class="type" data-type="326"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span>);
  }</span> else <span class="type" data-type="1054">{
    <span class="value-identifier" data-id="value: userInput/1342">userInput</span>
  }</span></span></span>;

  <span class="type" data-type="1217"><span class="type" data-type="732">let <span class="type" data-type="313"><span class="declaration-var" data-id="value: player/1344">player</span></span> = <span class="type" data-type="1424"><span class="type" data-type="285"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="273"><span class="field-value-identifier" data-id="attr: Play_types!.state - player">player</span></span></span></span>;
  <span class="type" data-type="655"><span class="type" data-type="475">let <span class="type" data-type="1351"><span class="declaration-var" data-id="value: stones/1345">stones</span></span> = <span class="type" data-type="102"><span class="type" data-type="63"><span class="module-identifier" data-id="module: Play_stones!">Play_stones</span>.<span class="value-identifier" data-id="value: Play_stones!.collideStones">collideStones</span></span>(<span class="type" data-type="1339"><span class="type" data-type="998"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="833"><span class="field-value-identifier" data-id="attr: Play_types!.state - stones">stones</span></span></span>)</span></span>;
  <span class="type" data-type="1267"><span class="type" data-type="528">let <span class="type" data-type="876">(<span class="type" data-type="1492"><span class="declaration-var" data-id="value: stones/1346">stones</span></span>, <span class="type" data-type="404"><span class="declaration-var" data-id="value: player/1347">player</span></span>)</span> = <span class="type" data-type="1468"><span class="type" data-type="200"><span class="value-identifier" data-id="value: collideStonesWithPlayer/1306">collideStonesWithPlayer</span></span>(<span class="type" data-type="22"><span class="value-identifier" data-id="value: stones/1345">stones</span></span>, <span class="type" data-type="486"><span class="value-identifier" data-id="value: player/1344">player</span></span>)</span></span>;
  <span class="type" data-type="310"><span class="type" data-type="291">let <span class="type" data-type="86"><span class="declaration-var" data-id="value: stones/1348">stones</span></span> = <span class="type" data-type="1401"><span class="type" data-type="1307"><span class="module-identifier" data-id="module: Play_stones!">Play_stones</span>.<span class="value-identifier" data-id="value: Play_stones!.moveStones">moveStones</span></span>(<span class="type" data-type="47"><span class="value-identifier" data-id="value: stones/1346">stones</span></span>, <span class="type" data-type="1085"><span class="type" data-type="52"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="1460"><span class="field-value-identifier" data-id="attr: Play_types!.state - blocks">blocks</span></span></span>)</span></span>;

  <span class="type" data-type="618"><span class="type" data-type="492">let <span class="type" data-type="507"><span class="declaration-var" data-id="value: player/1349">player</span></span> = <span class="type" data-type="714"><span class="type" data-type="683"><span class="value-identifier" data-id="value: movePlayer/1117">movePlayer</span></span>(<span class="type" data-type="1420"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>, <span class="type" data-type="1429"><span class="value-identifier" data-id="value: player/1347">player</span></span>, <span class="type" data-type="918"><span class="value-identifier" data-id="value: stones/1348">stones</span></span>, <span class="type" data-type="955"><span class="type" data-type="80"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="1039"><span class="field-value-identifier" data-id="attr: Play_types!.state - blocks">blocks</span></span></span>, <span class="type" data-type="364"><span class="value-identifier" data-id="value: timeScale/1341">timeScale</span></span>)</span></span>;
  <span class="type" data-type="1365"><span class="type" data-type="27">let <span class="type" data-type="1049"><span class="declaration-var" data-id="value: inputLeft/1350">inputLeft</span></span> = <span class="type" data-type="1288"><span class="type" data-type="609"><span class="type" data-type="352"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>.<span class="type" data-type="793"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span></span> <span class="type" data-type="632"><span class="boolean">?</span></span> <span class="type" data-type="392"><span class="boolean">true</span></span> <span class="type" data-type="578"><span class="boolean">:</span></span> <span class="type" data-type="554">(<span class="type" data-type="1443"><span class="type" data-type="56"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>.<span class="type" data-type="1341"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span></span> <span class="type" data-type="261"><span class="boolean">?</span></span> <span class="type" data-type="97"><span class="boolean">false</span></span> <span class="type" data-type="839"><span class="boolean">:</span></span> <span class="type" data-type="665"><span class="type" data-type="412"><span class="value-identifier" data-id="value: player/1349">player</span></span>.<span class="type" data-type="1045"><span class="field-value-identifier" data-id="attr: Play_types!.player - facingLeft">facingLeft</span></span></span>)</span></span></span>;
  <span class="type" data-type="932"><span class="type" data-type="908">let <span class="type" data-type="713"><span class="declaration-var" data-id="value: facingLeft/1351">facingLeft</span></span> = <span class="type" data-type="1187">switch <span class="type" data-type="1013"><span class="type" data-type="312"><span class="value-identifier" data-id="value: player/1349">player</span></span>.<span class="type" data-type="446"><span class="field-value-identifier" data-id="attr: Play_types!.player - throw">throw</span></span></span> {
  | <span class="type" data-type="164"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="836"><span class="value-identifier" data-id="value: inputLeft/1350">inputLeft</span></span>
  | <span class="type" data-type="227"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="213">(<span class="type" data-type="338">_</span>, <span class="type" data-type="576"><span class="declaration-var" data-id="value: v/1352">v</span></span>, <span class="type" data-type="1464">_</span>, <span class="type" data-type="1116">_</span>)</span>)</span> => <span class="type" data-type="1432"><span class="type" data-type="1192"><span class="type" data-type="1093"><span class="type" data-type="267"><span class="value-identifier" data-id="value: v/1352">v</span></span>.<span class="type" data-type="1223"><span class="field-module-identifier" data-id="module: Geom!">Geom</span>.<span class="field-value-identifier" data-id="attr: Geom!.vector - magnitude">magnitude</span></span></span> <span class="type" data-type="590"><span class="operator" data-id="value: Pervasives!.>">></span></span> <span class="type" data-type="498"><span class="float">5.</span></span></span> <span class="type" data-type="1350"><span class="boolean">?</span></span> <span class="type" data-type="1473"><span class="type" data-type="1036"><span class="type" data-type="371"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.vx">vx</span></span>(<span class="type" data-type="414"><span class="value-identifier" data-id="value: v/1352">v</span></span>)</span> <span class="type" data-type="1194"><span class="operator" data-id="value: Pervasives!.<"><</span></span> <span class="type" data-type="1202"><span class="float">0.</span></span></span> <span class="type" data-type="967"><span class="boolean">:</span></span> <span class="type" data-type="108"><span class="value-identifier" data-id="value: inputLeft/1350">inputLeft</span></span></span>
  }</span></span>;
  <span class="type" data-type="997"><span class="type" data-type="166">let <span class="type" data-type="1104"><span class="declaration-var" data-id="value: walkTimer/1353">walkTimer</span></span> = <span class="type" data-type="907">(<span class="type" data-type="1324"><span class="type" data-type="1109"><span class="type" data-type="891"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>.<span class="type" data-type="914"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - left">left</span></span></span> <span class="type" data-type="78"><span class="operator" data-id="value: Pervasives!.||">||</span></span> <span class="type" data-type="870"><span class="type" data-type="646"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>.<span class="type" data-type="419"><span class="field-value-identifier" data-id="attr: Play_types!.userInput - right">right</span></span></span></span> <span class="type" data-type="1397"><span class="boolean">?</span></span> <span class="type" data-type="947"><span class="type" data-type="904"><span class="type" data-type="440"><span class="value-identifier" data-id="value: player/1349">player</span></span>.<span class="type" data-type="671"><span class="field-value-identifier" data-id="attr: Play_types!.player - walkTimer">walkTimer</span></span></span> <span class="type" data-type="1419"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="1316"><span class="type" data-type="58"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.deltaTime">deltaTime</span></span>(<span class="type" data-type="383"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span></span> <span class="type" data-type="207"><span class="boolean">:</span></span> <span class="type" data-type="777"><span class="float">0.</span></span>)</span></span>;
  <span class="type" data-type="880"><span class="type" data-type="624">let <span class="type" data-type="755">(<span class="type" data-type="648"><span class="declaration-var" data-id="value: camera/1354">camera</span></span>, <span class="type" data-type="46"><span class="declaration-var" data-id="value: player/1355">player</span></span>)</span> = <span class="type" data-type="1191"><span class="type" data-type="410"><span class="module-identifier" data-id="module: Play_camera!">Play_camera</span>.<span class="value-identifier" data-id="value: Play_camera!.followPlayer">followPlayer</span></span>(<span class="type" data-type="100"><span class="value-identifier" data-id="value: player/1349">player</span></span>, <span class="type" data-type="1303"><span class="type" data-type="540"><span class="value-identifier" data-id="value: state/1340">state</span></span>.<span class="type" data-type="584"><span class="field-value-identifier" data-id="attr: Play_types!.state - camera">camera</span></span></span>, <span class="type" data-type="160"><span class="value-identifier" data-id="value: Play_types!.gameWidth">gameWidth</span></span>)</span></span>;
  <span class="type" data-type="1084"><span class="type" data-type="513">let <span class="type" data-type="433"><span class="declaration-var" data-id="value: player/1356">player</span></span> = <span class="type" data-type="225">if <span class="type" data-type="430">(<span class="type" data-type="526"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="1275"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Space">Space</span></span>, <span class="type" data-type="337"><span class="value-identifier" data-id="value: env/1339">env</span></span>))</span> <span class="type" data-type="255">{
    <span class="type" data-type="90"><span class="module-identifier" data-id="module: Play_touch!">Play_touch</span>.<span class="value-identifier" data-id="value: Play_touch!.switchSkin">switchSkin</span></span>(<span class="type" data-type="140"><span class="value-identifier" data-id="value: player/1355">player</span></span>)
  }</span> else <span class="type" data-type="1229">{
    <span class="value-identifier" data-id="value: player/1355">player</span>
  }</span></span></span>;
  <span class="type" data-type="1230"><span class="type" data-type="339">let <span class="type" data-type="1348"><span class="declaration-var" data-id="value: player/1357">player</span></span> = <span class="type" data-type="615">{...<span class="type" data-type="34"><span class="value-identifier" data-id="value: player/1356">player</span></span>, <span class="type" data-type="295"><span class="type" data-type="107"><span class="record-value-identifier" data-id="value: facingLeft/1351"><span class="value-identifier" data-id="value: facingLeft/1351">facingLeft</span></span></span>, <span class="type" data-type="1446"><span class="type" data-type="620"><span class="record-value-identifier" data-id="value: walkTimer/1353"><span class="value-identifier" data-id="value: walkTimer/1353">walkTimer</span></span></span>}</span></span></span></span>;

  <span class="type" data-type="1428"><span class="type" data-type="546">let <span class="type" data-type="1373"><span class="declaration-var" data-id="value: player/1358">player</span></span> = <span class="type" data-type="1160"><span class="type" data-type="865"><span class="value-identifier" data-id="value: dig/1287">dig</span></span>(<span class="type" data-type="1050"><span class="value-identifier" data-id="value: state/1340">state</span></span>, <span class="type" data-type="623"><span class="value-identifier" data-id="value: player/1357">player</span></span>, <span class="type" data-type="1364"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span>, <span class="type" data-type="647"><span class="value-identifier" data-id="value: facingLeft/1351">facingLeft</span></span>, <span class="type" data-type="533"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span></span>;

  <span class="type" data-type="748"><span class="type" data-type="391">let <span class="type" data-type="842"><span class="declaration-var" data-id="value: state/1359">state</span></span> = <span class="type" data-type="594">if <span class="type" data-type="517">(<span class="type" data-type="560"><span class="type" data-type="294"><span class="type" data-type="5"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.frameCount">frameCount</span></span>(<span class="type" data-type="416"><span class="value-identifier" data-id="value: env/1339">env</span></span>)</span> <span class="type" data-type="1076"><span class="value-identifier" data-id="value: Pervasives!.mod">mod</span></span> <span class="type" data-type="1227"><span class="int">100</span></span></span> <span class="type" data-type="787">=<span class="operator" data-id="value: Pervasives!.=">=</span></span> <span class="type" data-type="456"><span class="int">0</span></span>)</span> <span class="type" data-type="362">{
    <span class="type" data-type="941"><span class="value-identifier" data-id="value: maybeSave/1054">maybeSave</span></span>(<span class="type" data-type="1455"><span class="value-identifier" data-id="value: state/1340">state</span></span>, <span class="type" data-type="860"><span class="value-identifier" data-id="value: env/1339">env</span></span>)
  }</span> else <span class="type" data-type="454">{
    <span class="value-identifier" data-id="value: state/1340">state</span>
  }</span></span></span>;

  <span class="type" data-type="823">{
    ...<span class="type" data-type="747"><span class="value-identifier" data-id="value: state/1359">state</span></span>,
    <span class="type" data-type="1212"><span class="type" data-type="716"><span class="record-value-identifier" data-id="value: userInput/1343"><span class="value-identifier" data-id="value: userInput/1343">userInput</span></span></span>,
    <span class="type" data-type="1363"><span class="type" data-type="1342"><span class="record-value-identifier" data-id="value: stones/1348"><span class="value-identifier" data-id="value: stones/1348">stones</span></span></span>,
    <span class="type" data-type="786"><span class="type" data-type="241"><span class="record-value-identifier" data-id="value: camera/1354"><span class="value-identifier" data-id="value: camera/1354">camera</span></span></span>,
    <span class="type" data-type="1053"><span class="type" data-type="572"><span class="record-value-identifier" data-id="value: player/1358"><span class="value-identifier" data-id="value: player/1358">player</span></span></span>
  }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
}</span></span></span></span></span>;

<span class="type" data-type="896"><span class="string">/** Create 100 rocks to stress test the physics system. */</span>
let <span class="type" data-type="457"><span class="declaration-var" data-id="value: fillWithRocks/1360">fillWithRocks</span></span> = <span class="type" data-type="141">(<span class="type" data-type="167"><span class="declaration-var" data-id="value: state/1361">state</span></span>, <span class="type" data-type="1216"><span class="type" data-type="286"><span class="declaration-var" data-id="value: env/1362">env</span></span>) => <span class="type" data-type="963">{
  <span class="type" data-type="1042"><span class="type" data-type="343"><span class="module-identifier" data-id="module: GeomDebug!">GeomDebug</span>.<span class="value-identifier" data-id="value: GeomDebug!.range">range</span></span>(<span class="type" data-type="1153"><span class="int">100</span></span>)</span> <span class="type" data-type="1170"><span class="operator" data-id="value: Pervasives!.|>">|></span></span> <span class="type" data-type="567"><span class="type" data-type="315"><span class="module-identifier" data-id="module: List!">List</span>.<span class="value-identifier" data-id="value: List!.fold_left">fold_left</span></span>(<span class="type" data-type="481">(<span class="type" data-type="432"><span class="declaration-var" data-id="value: state/1363">state</span></span>, <span class="type" data-type="969"><span class="type" data-type="444"><span class="declaration-var" data-id="value: i/1364">i</span></span>) => <span class="type" data-type="75">{
    {...<span class="type" data-type="674"><span class="value-identifier" data-id="value: state/1363">state</span></span>, <span class="type" data-type="1169"><span class="record-value-identifier" data-id="attr: Play_types!.state - stones">stones</span>: <span class="type" data-type="89">[
      <span class="type" data-type="742">{
        <span class="type" data-type="228"><span class="record-module-identifier" data-id="module: Play_types!">Play_types</span>.<span class="record-module-identifier" data-id="module: Play_types!.Stone">Stone</span>.<span class="record-value-identifier" data-id="attr: Play_types!.Stone.t - circle">circle</span>: <span class="type" data-type="157">{
          <span class="type" data-type="1382"><span class="record-value-identifier" data-id="attr: Geom!.Circle.t - center">center</span>: <span class="type" data-type="293">{
            <span class="type" data-type="187"><span class="record-module-identifier" data-id="module: Geom!">Geom</span>.<span class="record-value-identifier" data-id="attr: Geom!.point - x">x</span>: <span class="type" data-type="910"><span class="type" data-type="3"><span class="module-identifier" data-id="module: Random!">Random</span>.<span class="value-identifier" data-id="value: Random!.float">float</span></span>(<span class="type" data-type="1362"><span class="type" data-type="1315"><span class="type" data-type="994"><span class="value-identifier" data-id="value: Pervasives!.float_of_int">float_of_int</span></span>(<span class="type" data-type="929"><span class="type" data-type="850"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.width">width</span></span>(<span class="type" data-type="668"><span class="value-identifier" data-id="value: env/1362">env</span></span>)</span>)</span> <span class="type" data-type="640"><span class="operator" data-id="value: Pervasives!.*.">*.</span></span> <span class="type" data-type="183"><span class="float">0.8</span></span></span>)</span>,
            <span class="type" data-type="626"><span class="record-value-identifier" data-id="attr: Geom!.point - y">y</span>: <span class="type" data-type="961"><span class="type" data-type="661"><span class="float">-300.</span></span> <span class="type" data-type="920"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="586"><span class="type" data-type="55"><span class="module-identifier" data-id="module: Random!">Random</span>.<span class="value-identifier" data-id="value: Random!.float">float</span></span>(<span class="type" data-type="825"><span class="float">100.</span></span>)</span></span>,
          }</span></span></span>,
          <span class="type" data-type="1390"><span class="record-value-identifier" data-id="attr: Geom!.Circle.t - rad">rad</span>: <span class="type" data-type="1079"><span class="type" data-type="1072"><span class="type" data-type="936"><span class="module-identifier" data-id="module: Random!">Random</span>.<span class="value-identifier" data-id="value: Random!.float">float</span></span>(<span class="type" data-type="1075"><span class="float">10.</span></span>)</span> <span class="type" data-type="991"><span class="operator" data-id="value: Pervasives!.+.">+.</span></span> <span class="type" data-type="524"><span class="float">10.</span></span></span>,
        }</span></span></span>,
        <span class="type" data-type="612"><span class="record-value-identifier" data-id="attr: Play_types!.Stone.t - vel">vel</span>: <span class="type" data-type="1241"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.v0">v0</span></span>,
        <span class="type" data-type="582"><span class="record-value-identifier" data-id="attr: Play_types!.Stone.t - rotation">rotation</span>: <span class="type" data-type="1297"><span class="type" data-type="38"><span class="module-identifier" data-id="module: Random!">Random</span>.<span class="value-identifier" data-id="value: Random!.float">float</span></span>(<span class="type" data-type="944"><span class="module-identifier" data-id="module: Geom!">Geom</span>.<span class="value-identifier" data-id="value: Geom!.pi">pi</span></span>)</span>,
        <span class="type" data-type="298"><span class="record-value-identifier" data-id="attr: Play_types!.Stone.t - live">live</span>: <span class="type" data-type="739"><span class="boolean">true</span></span>,
      }</span></span></span></span></span>,
      ...<span class="type" data-type="950"><span class="type" data-type="472"><span class="value-identifier" data-id="value: state/1363">state</span></span>.<span class="type" data-type="697"><span class="field-value-identifier" data-id="attr: Play_types!.state - stones">ston<span class="constructor-operator" data-id="constr: list/9 - ::">es</span></span></span></span>
    ]</span>}
  }</span></span></span></span>, <span class="type" data-type="1265"><span class="value-identifier" data-id="value: state/1361">state</span></span>)</span>
}</span></span></span></span>;

<span class="type" data-type="719"><span class="string">/** Runs stepping with some extra keyboard shortcuts for debugging.
 *
 * - Z toggles zooming in on the player
 * - Q adds a bunch of rocks via `fillWithRocks`
 * - F pause the game & step through frame-by-frame
 * - P play -- stop stepping
 * - H pause the game & step through hit-by-hit, examining each collision
 */</span>
let <span class="type" data-type="397"><span class="declaration-var" data-id="value: stepDebug/1365">stepDebug</span></span> = <span class="type" data-type="1226">(<span class="type" data-type="1090"><span class="declaration-var" data-id="value: state/1366">state</span></span>, <span class="type" data-type="143"><span class="type" data-type="43"><span class="declaration-var" data-id="value: context/1367">context</span></span>, <span class="type" data-type="1396"><span class="type" data-type="660"><span class="declaration-var" data-id="value: env/1368">env</span></span>) => <span class="type" data-type="1004">{
  <span class="type" data-type="815">let <span class="type" data-type="1083"><span class="declaration-var" data-id="value: state/1369">state</span></span> = <span class="type" data-type="1130"><span class="type" data-type="841"><span class="type" data-type="386"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="133"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Z">Z</span></span>, <span class="type" data-type="964"><span class="value-identifier" data-id="value: env/1368">env</span></span>)</span>
    <span class="type" data-type="1196"><span class="boolean">?</span></span> <span class="type" data-type="1400">{...<span class="type" data-type="702"><span class="value-identifier" data-id="value: state/1366">state</span></span>, <span class="type" data-type="1015"><span class="record-value-identifier" data-id="attr: Play_types!.state - zoom">zoom</span><span class="operator" data-id="value: Pervasives!.not">: <span class="type" data-type="1437"><span class="type" data-type="1435">!</span></span><span class="type" data-type="1269"><span class="type" data-type="152"><span class="value-identifier" data-id="value: state/1366">state</span></span>.<span class="type" data-type="455"><span class="field-value-identifier" data-id="attr: Play_types!.state - zoom">zoom</span></span></span></span>}</span></span>
    <span class="type" data-type="1485"><span class="boolean">:</span></span> <span class="type" data-type="1005"><span class="value-identifier" data-id="value: state/1366">state</span></span></span></span>;
  <span class="type" data-type="415">if <span class="type" data-type="1014">(<span class="type" data-type="174"><span class="value-identifier" data-id="value: state/1369">state</span></span>.<span class="type" data-type="71"><span class="field-value-identifier" data-id="attr: Play_types!.state - paused">paused</span></span>)</span> <span class="type" data-type="922">{
    <span class="value-identifier" data-id="value: state/1369">state</span>
  }</span> else <span class="type" data-type="649">if <span class="type" data-type="1179">(<span class="type" data-type="287"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="247"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - Q">Q</span></span>, <span class="type" data-type="628"><span class="value-identifier" data-id="value: env/1368">env</span></span>))</span> <span class="type" data-type="190">{
    <span class="type" data-type="70"><span class="value-identifier" data-id="value: fillWithRocks/1360">fillWithRocks</span></span>(<span class="type" data-type="835"><span class="value-identifier" data-id="value: state/1369">state</span></span>, <span class="type" data-type="487"><span class="value-identifier" data-id="value: env/1368">env</span></span>)
  }</span> else <span class="type" data-type="64">if <span class="type" data-type="20">(<span class="type" data-type="978"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="1347"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - F">F</span></span>, <span class="type" data-type="1209"><span class="value-identifier" data-id="value: env/1368">env</span></span>))</span> <span class="type" data-type="204">{
    {...<span class="type" data-type="669"><span class="type" data-type="617"><span class="value-identifier" data-id="value: step/1336">step</span></span>(<span class="type" data-type="734"><span class="value-identifier" data-id="value: state/1369">state</span></span>, <span class="type" data-type="608"><span class="value-identifier" data-id="value: context/1367">context</span></span>, <span class="type" data-type="903"><span class="value-identifier" data-id="value: env/1368">env</span></span>)</span>, <span class="type" data-type="1150"><span class="record-value-identifier" data-id="attr: Play_types!.state - frameByFrame">frameByFrame</span>: <span class="type" data-type="360"><span class="boolean">true</span></span>}
  }</span></span> else <span class="type" data-type="379">if <span class="type" data-type="822">(<span class="type" data-type="151"><span class="value-identifier" data-id="value: state/1369">state</span></span>.<span class="type" data-type="1041"><span class="field-value-identifier" data-id="attr: Play_types!.state - frameByFrame">frameByFrame</span></span>)</span> <span class="type" data-type="686">{
    if <span class="type" data-type="1399">(<span class="type" data-type="1001"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="230"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - P">P</span></span>, <span class="type" data-type="760"><span class="value-identifier" data-id="value: env/1368">env</span></span>))</span> <span class="type" data-type="1019">{
      {...<span class="type" data-type="119"><span class="value-identifier" data-id="value: state/1369">state</span></span>, <span class="type" data-type="348"><span class="record-value-identifier" data-id="attr: Play_types!.state - frameByFrame">frameByFrame</span>: <span class="type" data-type="281"><span class="boolean">false</span></span>}
    }</span></span> else <span class="type" data-type="720">if <span class="type" data-type="853">(<span class="type" data-type="1184"><span class="module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="module-identifier" data-id="module: Reprocessing!.Env">Env</span>.<span class="value-identifier" data-id="value: Reprocessing!.Env.keyPressed">keyPressed</span></span>(<span class="type" data-type="103"><span class="constructor-module-identifier" data-id="module: Reprocessing!">Reprocessing</span>.<span class="constructor-module-identifier" data-id="module: Reprocessing!.Events">Events</span>.<span class="constructor-module-identifier" data-id="constr: Reprocessing!.Events.keycodeT - H">H</span></span>, <span class="type" data-type="1112"><span class="value-identifier" data-id="value: env/1368">env</span></span>))</span> <span class="type" data-type="1113">{
      {...<span class="type" data-type="844"><span class="value-identifier" data-id="value: state/1369">state</span></span>, <span class="type" data-type="66"><span class="record-value-identifier" data-id="attr: Play_types!.state - hitByHit">hitByHit</span>: <span class="type" data-type="570">switch <span class="type" data-type="1358"><span class="type" data-type="1066"><span class="value-identifier" data-id="value: state/1369">state</span></span>.<span class="type" data-type="260"><span class="field-value-identifier" data-id="attr: Play_types!.state - hitByHit">hitByHit</span></span></span> {
      | <span class="type" data-type="1228"><span class="switch-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="673"><span class="declaration-var" data-id="value: x/1370">x</span></span>)</span> => <span class="type" data-type="330"><span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1312"><span class="type" data-type="1220"><span class="value-identifier" data-id="value: x/1370">x</span></span> <span class="type" data-type="545"><span class="operator" data-id="value: Pervasives!.+">+</span></span> <span class="type" data-type="583"><span class="int">1</span></span></span>)</span>
      | <span class="type" data-type="680"><span class="switch-module-identifier" data-id="constr: option/10 - None">None</span></span> => <span class="type" data-type="197"><span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="134"><span class="int">0</span></span>)</span>
      }</span>}
    }</span></span> else <span class="type" data-type="1242">{
      <span class="value-identifier" data-id="value: state/1369">state</span>
    }</span></span>
  }</span> else <span class="type" data-type="372">{
    <span class="type" data-type="650"><span class="value-identifier" data-id="value: step/1336">step</span></span>(<span class="type" data-type="137"><span class="value-identifier" data-id="value: state/1369">state</span></span>, <span class="type" data-type="1000"><span class="value-identifier" data-id="value: context/1367">context</span></span>, <span class="type" data-type="875"><span class="value-identifier" data-id="value: env/1368">env</span></span>);
  }</span></span></span></span></span>
}</span></span></span></span></span>;

<span class="type" data-type="11"><span class="string">/** Pause the game if the hardware back button is pressed */</span>
let <span class="type" data-type="740"><span class="declaration-var" data-id="value: backPressed/1371">backPressed</span></span> = <span class="type" data-type="1133">(<span class="type" data-type="328"><span class="declaration-var" data-id="value: state/1372">state</span></span>, <span class="type" data-type="733"><span class="type" data-type="443"><span class="declaration-var" data-id="value: context/1373">context</span></span>, <span class="type" data-type="1142"><span class="type" data-type="1087"><span class="declaration-var" data-id="value: env/1374">env</span></span>) => <span class="type" data-type="31">{
  if <span class="type" data-type="832">(<span class="type" data-type="672"><span class="value-identifier" data-id="value: state/1372">state</span></span>.<span class="type" data-type="544"><span class="field-value-identifier" data-id="attr: Play_types!.state - paused">paused</span></span>)</span> <span class="type" data-type="407">{
    <span class="constructor-module-identifier" data-id="constr: option/10 - None">None</span>
  }</span> else <span class="type" data-type="538">{
    <span class="constructor-module-identifier" data-id="constr: option/10 - Some">Some</span>(<span class="type" data-type="1236">{...<span class="type" data-type="1106"><span class="value-identifier" data-id="value: state/1372">state</span></span>, <span class="type" data-type="792"><span class="record-value-identifier" data-id="attr: Play_types!.state - paused">paused</span>: <span class="type" data-type="382"><span class="boolean">true</span></span>}</span></span>)
  }</span>
}</span></span></span></span></span>;</pre><script>window.TYPES_LIST = ["int",
  "bool",
  "int",
  "float",
  "float",
  "int",
  "Play_types.state",
  "bool",
  "Play_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "float * float -> Play_types.userInput -> Play_types.userInput",
  "bool",
  "Play_types.state -> 'a -> 'b -> Play_types.state option",
  "int -> int -> int",
  "Reprocessing.Events.keycodeT",
  "'c",
  "Geom.vector",
  "Play_types.Stone.t",
  "int",
  "Play_types.state",
  "Play_types.userInput",
  "bool",
  "float",
  "Play_types.Stone.t list",
  "bool",
  "int",
  "bool -> bool -> bool",
  "Play_types.Stone.t",
  "Play_types.state",
  "int",
  "int",
  "Play_types.userInput",
  "Play_types.state option",
  "Geom.Rect.t",
  "float",
  "Play_types.player",
  "int",
  "float",
  "float -> float -> float",
  "float",
  "float",
  "Geom.Rect.t",
  "int",
  "int",
  "'d",
  "Play_types.player ->\nPlay_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "float",
  "Play_types.player",
  "Play_types.Stone.t list",
  "Play_types.state ->\nPlay_types.player ->\nPlay_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "Play_types.userInput",
  "int",
  "bool",
  "Play_types.Block.t option array array",
  "bool -> bool -> bool",
  "Play_types.userInput",
  "float -> float",
  "bool",
  "Play_types.Stone.t list * Play_types.player",
  "float",
  "(int * int) list",
  "Play_types.Stone.t",
  "int",
  "bool",
  "Play_types.Stone.t list -> Play_types.Stone.t list",
  "Play_types.state",
  "Play_types.Block.blockKind",
  "Play_types.state",
  "Play_types.userInput",
  "Play_types.Block.t option array array -> int -> int",
  "int",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.state",
  "float -> float -> bool",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.state",
  "(int * int) list",
  "bool",
  "bool -> bool -> bool",
  "float",
  "Play_types.state",
  "Play_types.player",
  "float -> float -> bool",
  "Play_types.player -> Geom.vector -> Play_types.player",
  "unit",
  "bool",
  "Play_types.Stone.t list",
  "int",
  "float -> float -> float",
  "Play_types.Stone.t list",
  "Play_types.player -> Play_types.player",
  "Play_types.Stone.t list -> Play_types.player -> bool",
  "float",
  "int",
  "Reprocessing.Events.keycodeT",
  "int",
  "Play_types.Stone.t list -> Play_types.player -> bool",
  "bool",
  "Play_types.userInput",
  "float",
  "Play_types.player",
  "float -> float -> bool",
  "Play_types.Stone.t list",
  "Reprocessing.Events.keycodeT",
  "Play_types.Stone.t list",
  "int",
  "Play_types.player",
  "bool",
  "bool",
  "Play_types.state",
  "float",
  "Geom.vector",
  "float option",
  "float -> float",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ]",
  "Play_types.player",
  "int -> int -> int",
  "int",
  "Play_types.userInput",
  "Play_types.state",
  "int -> int -> int",
  "int",
  "Reprocessing_Common.glEnv",
  "Play_types.Stone.t list",
  "float",
  "Play_types.Stone.t",
  "(int * int) list -> unit",
  "int * int",
  "Reprocessing.Events.keycodeT",
  "Play_types.player",
  "float",
  "bool",
  "Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Reprocessing.Events.keycodeT",
  "int",
  "int",
  "Geom.Rect.t",
  "Play_types.state",
  "(int * int) list -> unit",
  "Play_types.userInput",
  "Play_types.player",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.userInput",
  "'d -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Geom.vector",
  "Play_types.Inventory.t",
  "Play_types.userInput",
  "Geom.vector",
  "Play_types.Block.t option",
  "float",
  "int",
  "Play_types.state",
  "Play_types.state",
  "Geom.vector",
  "bool",
  "Play_types.userInput",
  "Play_types.player",
  "Geom.Circle.t",
  "bool",
  "Play_types.state",
  "float",
  "float",
  "bool",
  "bool",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "float",
  "float",
  "Play_types.state",
  "float",
  "Play_types.Inventory.item",
  "bool",
  "Play_types.player",
  "Reprocessing_Common.glEnv",
  "bool",
  "Play_types.state",
  "Play_types.Stone.t list",
  "float -> float -> float",
  "int",
  "float",
  "Play_types.userInput -> bool -> (int * int) list",
  "float * float",
  "int",
  "Play_types.player",
  "float",
  "Play_types.Block.t",
  "Play_types.userInput",
  "bool -> bool -> bool",
  "Geom.point",
  "Play_types.userInput",
  "Play_types.userInput",
  "Play_types.state",
  "Play_types.Block.t option",
  "int",
  "bool",
  "float",
  "Play_types.Stone.t",
  "Geom.vector",
  "int option",
  "Reprocessing_Types.Types.glEnvT",
  "Reprocessing.Events.keycodeT",
  "Play_types.Stone.t list * Play_types.player",
  "float",
  "unit",
  "Play_types.Inventory.t",
  "Play_types.state",
  "float",
  "Play_types.userInput",
  "bool",
  "Play_types.Block.t",
  "int",
  "Play_types.player",
  "Reprocessing_Common.glEnv",
  "float -> float",
  "Geom.point * Geom.vector * Play_types.Stone.t * float",
  "float",
  "Geom.vector -> float",
  "Geom.Circle.t",
  "Play_types.state ->\nPlay_types.player -> Play_types.Block.t -> int -> int -> unit",
  "bool",
  "float",
  "Geom.Rect.t",
  "float",
  "float",
  "bool",
  "bool",
  "Play_types.player",
  "Play_types.Stone.t list * Play_types.player",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "Play_types.Stone.t",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "Reprocessing.Events.keycodeT",
  "Geom.Circle.t",
  "Play_types.Stone.t list ->\nPlay_types.player -> Play_types.Stone.t list * Play_types.player",
  "Geom.point",
  "float",
  "float",
  "bool",
  "Play_types.userInput",
  "Play_types.Inventory.item * int",
  "Play_types.Stone.t list ->\nPlay_types.player -> Play_types.Stone.t list * Play_types.player",
  "Play_types.state",
  "Play_types.state",
  "Play_types.player",
  "Geom.vector",
  "bool",
  "Play_types.userInput",
  "Play_types.userInput",
  "Reprocessing.Events.keycodeT",
  "Play_types.player",
  "bool",
  "int -> int -> int",
  "Play_types.player",
  "Play_types.Stone.t",
  "int",
  "Reprocessing.Events.keycodeT",
  "Play_types.player",
  "Play_types.Stone.t",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Geom.Rect.t",
  "Play_types.Inventory.item * int",
  "Play_types.state",
  "bool",
  "Play_types.userInput",
  "float -> float -> float",
  "Play_types.userInput",
  "(int * int) list -> unit",
  "Play_types.player",
  "float",
  "float -> float * float -> Play_types.userInput -> Play_types.userInput",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "(int * int) list",
  "(Play_types.Inventory.item * int) array ->\n(Play_types.Inventory.item * int -> bool) -> int option",
  "Play_types.state",
  "unit",
  "Geom.Circle.t",
  "Play_types.state ->\nPlay_types.player -> Play_types.Block.t -> int -> int -> unit",
  "Geom.Rect.t -> Geom.vector -> Geom.Rect.t",
  "Play_types.userInput",
  "Play_types.state",
  "bool",
  "bool",
  "bool",
  "Play_types.state",
  "float option -> float option -> bool",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "'c -> Reprocessing_Common.glEnv -> Play_types.userInput",
  "Geom.vector",
  "int",
  "Play_types.Stone.t list",
  "Geom.point",
  "Geom.point",
  "int",
  "Play_types.player",
  "float",
  "Play_types.userInput",
  "Play_types.Stone.t",
  "Play_types.userInput ->\nReprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "Geom.Rect.t -> Geom.vector -> Geom.Rect.t",
  "Play_types.Stone.t list ->\nPlay_types.player -> Play_types.Stone.t list * Play_types.player",
  "Play_types.player ->\nPlay_types.Stone.t list -> 'e option array array -> 'f -> Play_types.player",
  "Reprocessing_Common.glEnv",
  "unit -> bool",
  "(unit -> bool) option",
  "Play_types.Stone.t",
  "Geom.vector",
  "Play_types.Inventory.item",
  "bool",
  "Play_types.state",
  "Play_types.userInput -> Play_types.userInput -> Play_types.userInput",
  "Play_types.player",
  "Play_types.player",
  "bool",
  "int list -> Play_types.state",
  "int",
  "Play_types.userInput",
  "Play_types.userInput",
  "Play_types.Stone.t list",
  "'f",
  "Play_types.Stone.t",
  "int * int",
  "Geom.vector",
  "Geom.vector",
  "Play_types.userInput -> Play_types.userInput -> Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Block.blockKind -> Play_types.Block.blockKind -> bool",
  "Play_types.state",
  "float",
  "int option",
  "int",
  "Play_types.player",
  "bool",
  "bool",
  "bool",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Geom.point",
  "Play_types.player",
  "float",
  "Play_types.player",
  "bool",
  "int list",
  "int",
  "Play_types.player",
  "Play_types.Stone.t",
  "Play_types.userInput",
  "Play_types.state",
  "bool",
  "Play_types.state",
  "float -> float -> bool",
  "bool",
  "float -> float -> float",
  "int",
  "Reprocessing_Types.Types.glEnvT -> float",
  "unit",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.userInput",
  "bool",
  "float",
  "Play_types.state",
  "bool",
  "float",
  "Play_types.userInput",
  "float",
  "float",
  "int",
  "Play_types.state ->\nPlay_types.player -> Play_types.Block.t -> int -> int -> unit",
  "int",
  "float",
  "Play_types.state",
  "float",
  "Geom.Rect.t -> Geom.pector -> Geom.Aabb.t -> bool",
  "bool",
  "int",
  "int -> int -> unit",
  "Reprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "Play_types.state",
  "Play_types.Stone.t list * Play_types.player",
  "float -> float -> bool",
  "bool",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Block.t",
  "Play_types.Stone.t",
  "Play_types.state",
  "float",
  "float",
  "(int * int) list",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state",
  "bool",
  "Play_types.state",
  "Play_types.Inventory.item",
  "Play_types.player",
  "'e option array array",
  "Play_types.state -> 'd -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.Inventory.t -> Play_types.Inventory.item -> int -> unit",
  "Geom.point ->\nGeom.vector ->\nGeom.vector ->\nbool ->\n?reallyCheckJump:(unit -> bool) ->\n(Geom.pector -> Geom.Aabb.t -> bool) ->\n(Geom.vector -> Geom.pector -> Geom.Aabb.t -> Geom.vector) ->\n'e option array array ->\nbool *\n(Geom.vector *\n (Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list)",
  "key:string -> value:int -> Reprocessing_Types.Types.glEnvT -> bool",
  "Play_types.player",
  "int * int",
  "bool -> bool -> bool",
  "Play_types.player",
  "Play_types.Block.t option array array ->\nint * int -> Play_types.Block.t option",
  "Play_types.userInput",
  "Play_types.state option",
  "Geom.vector",
  "bool",
  "(float * float * float * float) * Play_types.player",
  "Play_types.userInput",
  "bool",
  "float",
  "Geom.vector",
  "Play_types.state",
  "Reprocessing_Types.Types.glEnvT",
  "float",
  "int",
  "Play_types.userInput",
  "Play_types.userInput -> Play_types.userInput -> Play_types.userInput",
  "float",
  "Play_types.Stone.t list",
  "Geom.vector",
  "(int * int) list",
  "float",
  "Geom.point",
  "float",
  "bool",
  "int",
  "bool",
  "Play_types.userInput",
  "Play_types.state",
  "Play_types.player",
  "(int * int) list",
  "Play_types.Inventory.t",
  "Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT -> int",
  "Geom.vector",
  "(int * int) list -> unit",
  "Play_types.player",
  "bool -> bool -> bool",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "'a -> 'b -> Play_types.state option",
  "int -> Play_types.state",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.player",
  "Play_types.userInput",
  "unit",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "bool",
  "float",
  "Play_types.player",
  "Play_types.Block.t option",
  "Play_types.state",
  "Play_types.state",
  "int",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.Inventory.item * int",
  "Play_types.player",
  "Play_types.userInput",
  "Play_types.Stone.t list * Play_types.player",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "bool",
  "bool",
  "bool",
  "bool",
  "Play_types.userInput",
  "Geom.Aabb.t -> Geom.Circle.t -> Geom.vector",
  "Play_types.userInput",
  "unit",
  "Geom.vector",
  "Play_types.state",
  "Play_types.userInput",
  "Play_types.Stone.t",
  "Play_types.state",
  "Play_types.player",
  "bool",
  "Play_types.Stone.t list -> Play_types.player -> bool",
  "Play_types.Stone.t",
  "bool -> bool",
  "Play_types.state -> int -> Play_types.state",
  "Geom.point",
  "unit",
  "Reprocessing_Types.Types.glEnvT -> int",
  "Play_types.state -> 'g -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Stone.t",
  "Play_types.Inventory.item",
  "(Play_types.Inventory.item * int) array",
  "Play_types.userInput",
  "Play_types.state",
  "unit",
  "Play_types.userInput -> Play_types.userInput",
  "float",
  "Play_types.userInput",
  "Play_types.userInput",
  "float",
  "Geom.vector",
  "bool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "Play_types.player",
  "Play_types.player",
  "bool",
  "float",
  "Play_types.state -> 'g -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "bool",
  "Play_types.player",
  "Play_types.userInput",
  "Play_types.state",
  "Geom.Rect.t -> Geom.Circle.t -> bool",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.userInput",
  "Play_types.player",
  "Play_types.player",
  "bool",
  "Play_types.Stone.t list * Play_types.player",
  "bool",
  "Play_types.userInput",
  "Geom.Rect.t",
  "bool",
  "float",
  "Play_types.Inventory.t",
  "float",
  "float",
  "unit",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "unit",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.userInput",
  "Play_types.userInput",
  "Geom.vector",
  "Play_types.state",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.player -> Play_types.userInput -> bool -> (int * int) list",
  "Reprocessing_Common.glEnv",
  "Play_types.userInput",
  "Play_types.userInput",
  "Play_types.state option",
  "Reprocessing_Common.glEnv",
  "Play_types.state",
  "float",
  "Geom.vector",
  "Play_types.Block.t option",
  "Play_types.state",
  "int -> int -> int",
  "Play_types.player",
  "Play_types.Stone.t -> Play_types.Stone.t list * Play_types.player",
  "bool",
  "Reprocessing_Common.glEnv",
  "Play_types.userInput",
  "bool -> bool -> bool",
  "bool",
  "bool",
  "bool",
  "Geom.vector -> Geom.vector",
  "bool",
  "Play_types.Stone.t",
  "int",
  "unit",
  "Reprocessing_Types.Types.glEnvT -> int",
  "'g",
  "Geom.vector",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "int",
  "Play_types.userInput",
  "bool",
  "(Play_types.state -> int -> Play_types.state) ->\nPlay_types.state -> int list -> Play_types.state",
  "Play_types.Block.t option array array",
  "float * float * float * float",
  "int option",
  "Geom.vector",
  "Play_types.state",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.userInput",
  "Geom.vector",
  "Geom.vector",
  "Play_types.Stone.t list",
  "bool",
  "Play_types.Inventory.item * int -> bool",
  "Play_types.state",
  "Play_types.player",
  "Play_types.Stone.t",
  "int",
  "Play_types.state",
  "float",
  "float",
  "Reprocessing_Types.Types.glEnvT -> (float, float * float) Hashtbl.t",
  "float",
  "Play_types.player",
  "float -> float -> bool",
  "Play_types.player",
  "(int * int) list",
  "(int * int) list",
  "Play_types.state",
  "Play_types.Stone.t",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ]",
  "Geom.Circle.t",
  "Geom.vector",
  "(Play_types.Stone.t list * Play_types.player ->\n Play_types.Stone.t -> Play_types.Stone.t list * Play_types.player) ->\nPlay_types.Stone.t list * Play_types.player ->\nPlay_types.Stone.t list -> Play_types.Stone.t list * Play_types.player",
  "Play_types.Inventory.t",
  "float",
  "Play_types.player",
  "bool",
  "bool",
  "int",
  "Play_types.state",
  "Play_types.state",
  "'d",
  "bool",
  "float",
  "Play_types.player",
  "Play_types.Stone.t",
  "Geom.point -> int * int",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.player",
  "(float -> float * float -> Play_types.userInput -> Play_types.userInput) ->\n(float, float * float) Hashtbl.t ->\nPlay_types.userInput -> Play_types.userInput",
  "Play_types.state",
  "Play_types.player",
  "bool",
  "float",
  "bool",
  "Geom.vector",
  "Play_types.player",
  "Play_types.state",
  "float",
  "Geom.point",
  "float",
  "Reprocessing_Types.Types.glEnvT",
  "Timer.t -> Reprocessing_Types.Types.glEnvT -> (float * float) * bool",
  "Play_types.userInput",
  "int -> int -> int",
  "bool",
  "Play_types.userInput",
  "Play_types.Inventory.t -> Play_types.Inventory.item -> int -> unit",
  "float",
  "int -> int -> bool",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "Play_types.player",
  "Play_types.state ->\nPlay_types.player ->\nPlay_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "float -> float -> float",
  "Geom.vector",
  "int",
  "Play_types.state",
  "Play_types.Stone.t",
  "float -> float -> float",
  "bool",
  "bool",
  "float * float * float * float",
  "Play_types.state",
  "Play_types.state -> 'd -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "int",
  "Geom.Rect.t",
  "Play_types.Block.t -> int -> int -> unit",
  "int * int",
  "Play_types.Stone.t list",
  "int * int",
  "Play_types.Stone.t",
  "Play_types.Stone.t -> bool",
  "Play_types.Stone.t",
  "Reprocessing_Types.Types.glEnvT",
  "float",
  "[> `Jump | `Left | `Right ] option",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Geom.Rect.t",
  "Play_types.player",
  "Play_types.userInput -> Play_types.userInput",
  "Play_types.Stone.t list * Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state -> 'd -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.userInput",
  "Play_types.player",
  "Play_types.state",
  "int",
  "Play_types.state",
  "Play_types.Inventory.item",
  "(int * int) list",
  "int option",
  "Play_types.player",
  "Play_types.userInput",
  "int option",
  "(float, float * float) Hashtbl.t",
  "int",
  "Play_types.player",
  "Play_types.player",
  "Reprocessing.Events.keycodeT",
  "Play_types.state",
  "(Play_types.Inventory.item * int) array",
  "Geom.vector -> (Geom.vector -> Geom.vector) -> Geom.vector",
  "float -> float -> bool",
  "int",
  "Play_types.player",
  "bool",
  "Play_types.Inventory.t -> Play_types.Inventory.item -> int -> unit",
  "Play_types.state",
  "Play_types.player",
  "float",
  "Play_types.state",
  "unit",
  "int -> int -> int",
  "Play_types.player -> Play_types.userInput -> bool -> (int * int) list",
  "float",
  "Play_types.state",
  "Play_types.Stone.t list",
  "Reprocessing_Types.Types.glEnvT -> float",
  "Play_types.Stone.t",
  "Play_types.player",
  "int",
  "float",
  "Play_types.state",
  "bool",
  "float",
  "bool",
  "bool",
  "Play_types.userInput ->\nPlay_types.player ->\nPlay_types.Stone.t list ->\nPlay_types.Block.t option array array -> float -> Play_types.player",
  "float -> float -> float",
  "Play_types.state",
  "Play_types.Block.t",
  "int",
  "Play_types.state -> 'd -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.state",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "int",
  "bool",
  "Play_types.userInput",
  "Play_types.Stone.t",
  "Geom.Rect.t",
  "Play_types.Block.blockKind",
  "float",
  "Play_types.player",
  "bool",
  "bool",
  "Play_types.player",
  "'a",
  "Play_types.state",
  "int",
  "bool",
  "float",
  "Play_types.Stone.t list -> Play_types.player -> bool",
  "bool",
  "Play_types.state -> 'a -> 'b -> Play_types.state option",
  "Play_types.userInput",
  "Play_types.Stone.t",
  "Play_types.state",
  "(int * int) list",
  "Play_types.Inventory.item * int",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state",
  "Play_types.state",
  "bool",
  "Play_types.state",
  "int",
  "unit",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Play_types.Stone.t",
  "(float * float * float * float) * Play_types.player",
  "Play_types.userInput",
  "float",
  "Play_types.state",
  "(int * int) list",
  "Reprocessing_Types.Types.glEnvT",
  "bool",
  "Play_types.userInput",
  "float -> float -> float",
  "Geom.vector",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option ->\n(Geom.point * Geom.vector * Play_types.Stone.t * float) option -> bool",
  "Play_types.userInput",
  "Geom.vector",
  "Geom.vector",
  "Play_types.Inventory.item * int -> bool",
  "Geom.vector",
  "Play_types.Block.t -> int -> int -> unit",
  "bool",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.Stone.t",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "float",
  "Play_types.Block.t",
  "Play_types.userInput",
  "int * int",
  "Play_types.player",
  "Play_types.userInput",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ]",
  "bool *\n(Geom.vector *\n (Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list)",
  "Geom.Rect.t",
  "float * float * float * float",
  "int -> int -> bool",
  "Geom.vector",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "Geom.vector",
  "Geom.Rect.t",
  "Play_types.state",
  "Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.state",
  "Play_types.userInput",
  "float",
  "Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "Play_types.userInput",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Play_types.player",
  "Play_types.Inventory.t",
  "Reprocessing_Types.Types.glEnvT",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Block.t -> int -> int -> unit",
  "Geom.vector",
  "float",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ]",
  "Play_types.state -> 'g -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.player",
  "Play_types.Stone.t",
  "(int * int) list",
  "Play_types.Block.t",
  "bool",
  "Play_types.state",
  "Play_types.player",
  "Play_types.player",
  "Geom.vector",
  "bool",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state",
  "bool",
  "Play_types.state",
  "float",
  "float",
  "Play_types.player",
  "Play_types.Inventory.t",
  "Play_types.userInput",
  "Reprocessing_Common.glEnv -> Play_types.userInput",
  "Play_types.player -> Play_types.userInput -> bool -> (int * int) list",
  "Reprocessing_Types.Types.glEnvT -> float",
  "bool",
  "Play_types.state",
  "bool",
  "Play_types.state",
  "bool",
  "Play_types.player",
  "Geom.pector -> Geom.Aabb.t -> bool",
  "bool",
  "Geom.vector",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "Play_types.state",
  "Geom.point",
  "Play_types.state",
  "Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT",
  "int",
  "bool",
  "bool -> bool -> bool",
  "int",
  "int",
  "float",
  "bool",
  "Play_types.userInput",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ]",
  "float",
  "Play_types.userInput",
  "Play_types.player",
  "(int * int) list -> unit",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Inventory.t",
  "Geom.Rect.t",
  "(int * int) list",
  "float",
  "Play_types.player",
  "Play_types.userInput",
  "unit",
  "Play_types.userInput",
  "float -> float -> float",
  "Play_types.userInput",
  "Play_types.player",
  "Geom.Circle.t",
  "Geom.Rect.t",
  "Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.player",
  "Play_types.userInput",
  "float",
  "(float * float * float * float) * Play_types.player",
  "int * int",
  "int",
  "bool",
  "Geom.point",
  "Reprocessing_Types.Types.glEnvT",
  "int",
  "Play_types.state",
  "float",
  "(Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list",
  "Geom.vector",
  "Play_types.userInput",
  "Play_types.userInput",
  "Play_types.userInput",
  "int * int",
  "Geom.vector",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "bool",
  "Play_types.Stone.t list",
  "Play_types.Stone.t",
  "int -> float",
  "float * float * float * float",
  "Geom.vector -> Geom.pector -> Geom.Aabb.t -> Geom.vector",
  "Reprocessing_Types.Types.glEnvT",
  "float",
  "Play_types.state",
  "bool -> bool -> bool",
  "float",
  "Play_types.state",
  "Reprocessing_Common.glEnv",
  "float -> float",
  "Reprocessing_Types.Types.glEnvT -> bool",
  "Geom.vector",
  "bool -> bool -> bool",
  "Play_types.userInput",
  "Geom.point",
  "Play_types.userInput",
  "int",
  "Play_types.Stone.t list",
  "unit",
  "float -> float -> float",
  "bool",
  "Play_types.state",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Geom.point",
  "int",
  "unit",
  "Geom.vector",
  "Play_types.state",
  "Reprocessing_Types.Types.glEnvT -> int",
  "Geom.Aabb.t",
  "Play_types.userInput",
  "bool",
  "Geom.vector -> Geom.vector -> Geom.vector",
  "Play_types.userInput",
  "int * int",
  "float",
  "Play_types.userInput",
  "Play_types.userInput",
  "bool",
  "Reprocessing_Types.Types.glEnvT -> int",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "bool",
  "(int * int) list",
  "float",
  "bool",
  "float",
  "float",
  "float",
  "float",
  "Play_types.Stone.t list",
  "bool",
  "Play_types.player",
  "bool",
  "Play_types.userInput",
  "Play_types.Block.t option array array",
  "int",
  "Play_types.state",
  "int",
  "int option",
  "float",
  "float",
  "Play_types.userInput",
  "Play_types.state",
  "Reprocessing_Types.Types.glEnvT",
  "int * int",
  "Geom.vector -> (Geom.vector -> Geom.vector) -> Geom.vector",
  "bool",
  "Play_types.userInput",
  "int",
  "Play_types.userInput",
  "int",
  "Reprocessing_Types.Types.glEnvT -> float",
  "Geom.Rect.t",
  "Reprocessing_Common.glEnv",
  "float -> float -> float",
  "Geom.point",
  "Play_types.Inventory.item",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "(Play_types.Inventory.item * int) array ->\n(Play_types.Inventory.item * int -> bool) -> int option",
  "bool",
  "Play_types.userInput ->\nPlay_types.player ->\nPlay_types.Stone.t list -> 'e option array array -> 'f -> Play_types.player",
  "Geom.Rect.t",
  "float option",
  "bool -> bool -> bool",
  "Play_types.state",
  "bool",
  "Reprocessing.Events.keycodeT",
  "float",
  "Play_types.Stone.t",
  "int",
  "float -> float -> float",
  "Geom.vector -> float -> Geom.vector",
  "Play_types.Stone.t list * Play_types.player",
  "int -> float",
  "Play_types.userInput ->\nPlay_types.player ->\nPlay_types.Stone.t list -> 'e option array array -> 'f -> Play_types.player",
  "float",
  "Play_types.state",
  "Play_types.state",
  "Geom.Rect.t -> Geom.Circle.t -> bool",
  "'d",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "Reprocessing.Events.keycodeT",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Play_types.state",
  "Play_types.state",
  "(int * int) list",
  "unit",
  "Play_types.player",
  "Play_types.userInput",
  "Play_types.Stone.t",
  "bool",
  "Play_types.Stone.t",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "bool",
  "Play_types.state",
  "int",
  "bool",
  "bool *\n(Geom.vector *\n (Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list)",
  "Play_types.state",
  "int -> unit",
  "Play_types.Stone.t",
  "Timer.t",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Play_types.userInput",
  "(int * int) list",
  "Play_types.Inventory.item",
  "Play_types.Stone.t list * Play_types.player",
  "bool",
  "unit",
  "bool",
  "Play_types.Inventory.item * int",
  "Reprocessing_Common.glEnv",
  "float",
  "(int * int) list",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "bool",
  "Play_types.userInput",
  "float option",
  "Play_types.state",
  "int * int",
  "Play_types.state",
  "int -> int list",
  "int",
  "unit",
  "Play_types.player",
  "bool",
  "Reprocessing_Common.glEnv",
  "Play_types.player",
  "bool",
  "Play_types.state",
  "Play_types.Inventory.item -> Play_types.Inventory.item -> bool",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Play_types.player",
  "Play_types.userInput",
  "Geom.vector",
  "Geom.vector -> Geom.vector",
  "bool",
  "Play_types.Stone.t list -> 'e option array array -> 'f -> Play_types.player",
  "bool",
  "Geom.vector -> float -> Geom.vector",
  "Play_types.Block.t",
  "Play_types.userInput",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "(int * int) list",
  "bool",
  "int option",
  "Play_types.state",
  "Play_types.userInput",
  "bool",
  "int",
  "Play_types.Inventory.item -> int -> unit",
  "float",
  "Play_types.userInput",
  "Geom.vector",
  "float",
  "int -> int -> int",
  "Play_types.player -> Play_types.Block.t -> int -> int -> unit",
  "Play_types.state",
  "float -> float",
  "Play_types.Block.t option",
  "bool",
  "bool",
  "Play_types.state",
  "Play_types.state",
  "Play_types.state",
  "bool",
  "'b -> Play_types.state option",
  "bool",
  "int option",
  "Play_types.state",
  "Play_types.Block.t option",
  "Play_types.Block.t option",
  "bool",
  "Geom.vector *\n(Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list",
  "Play_types.Inventory.item * int",
  "int -> int -> bool",
  "Play_types.player -> bool",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.Block.t option array",
  "float",
  "float -> int",
  "Play_types.Stone.t list * Play_types.player",
  "Geom.Rect.t",
  "float",
  "bool *\n(Geom.vector *\n (Geom.vector * Geom.vector * (int * int) * Geom.pector * Geom.Aabb.t) list)",
  "Play_types.state",
  "Timer.t",
  "Geom.vector",
  "bool",
  "Play_types.userInput",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state",
  "Play_types.player",
  "(float * float) * bool",
  "float",
  "Play_types.player",
  "Geom.vector",
  "Geom.vector -> (Geom.vector -> Geom.vector) -> Geom.vector",
  "'g -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "float",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "bool",
  "bool",
  "Play_types.Block.t",
  "Play_types.state",
  "Play_types.state",
  "Play_types.Stone.t -> Geom.vector -> Play_types.Stone.t",
  "Geom.Rect.t -> Geom.Circle.t -> bool",
  "bool",
  "Geom.Rect.t",
  "float * float -> Geom.point",
  "Play_types.state -> 'a -> 'b -> Play_types.state option",
  "Reprocessing_Types.Types.glEnvT -> float",
  "Geom.vector",
  "float",
  "bool",
  "bool -> bool",
  "bool",
  "Geom.Rect.t -> Geom.vector -> Geom.Rect.t",
  "Geom.Rect.t -> Geom.Aabb.t",
  "'b",
  "(int * int) list",
  "Reprocessing.Events.keycodeT",
  "Play_types.Stone.t list -> int",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Play_types.state ->\nPlay_types.player ->\nPlay_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "Geom.point ->\nReprocessing_Types.Types.glEnvT -> [> `Jump | `Left | `Right ] option",
  "int",
  "Play_types.state",
  "int",
  "int",
  "int",
  "Geom.vector",
  "float",
  "Reprocessing_Types.Types.glEnvT",
  "bool",
  "Geom.vector",
  "bool",
  "Play_types.state ->\nPlay_types.player ->\nPlay_types.userInput ->\nbool -> Reprocessing_Types.Types.glEnvT -> Play_types.player",
  "bool",
  "Play_types.Block.t -> int -> int -> unit",
  "float",
  "float",
  "float",
  "Geom.vector -> Geom.vector",
  "bool -> bool -> bool",
  "int",
  "Play_types.state",
  "int list -> (int list -> Play_types.state) -> Play_types.state",
  "Play_types.state",
  "bool",
  "Geom.point * Geom.vector * Play_types.Stone.t * float",
  "Play_types.Stone.t",
  "float",
  "float",
  "bool -> bool -> bool",
  "float",
  "bool",
  "(int * int) list",
  "Play_types.Inventory.t",
  "bool",
  "Geom.vector",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Types.Types.glEnvT -> bool",
  "int option",
  "Geom.Rect.t -> Geom.vector -> Geom.Rect.t",
  "bool",
  "Play_types.state",
  "(float * float) * bool",
  "float option",
  "Play_types.player ->\nfloat * float * float * float ->\nfloat -> (float * float * float * float) * Play_types.player",
  "Geom.vector",
  "int",
  "float -> float -> bool",
  "Play_types.state",
  "bool",
  "Play_types.Stone.t list",
  "int",
  "Play_types.Stone.t list",
  "bool",
  "string",
  "float",
  "Play_types.player",
  "int -> unit",
  "Play_types.userInput",
  "(float * float) * bool",
  "(Play_types.Inventory.item * int) array",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.state",
  "bool",
  "Play_types.userInput",
  "unit",
  "Play_types.Block.t -> int -> int -> unit",
  "Reprocessing_Types.Types.glEnvT",
  "Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.state",
  "Geom.Rect.t -> Geom.vector -> Geom.pector -> Geom.Aabb.t -> Geom.vector",
  "bool",
  "int",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.player",
  "Geom.vector",
  "float",
  "Play_types.Inventory.t",
  "Play_types.state -> 'd -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "int",
  "int option",
  "Play_types.player",
  "Play_types.state",
  "bool",
  "Reprocessing_Common.KeySet.elt -> Reprocessing_Common.glEnv -> bool",
  "Play_types.Stone.t list * Play_types.player",
  "Geom.Rect.t",
  "bool",
  "Play_types.state",
  "Play_types.Inventory.t",
  "bool",
  "Play_types.player",
  "Play_types.userInput",
  "Geom.vector",
  "Play_types.state",
  "(int * int) list",
  "Play_types.userInput",
  "Play_types.userInput",
  "Geom.vector",
  "Play_types.Stone.t list",
  "int option",
  "Play_types.Stone.t",
  "Play_types.Block.t option array array",
  "(Play_types.Inventory.item * int) array",
  "unit",
  "Geom.Rect.t",
  "int",
  "bool -> bool -> bool",
  "int",
  "float",
  "Play_types.userInput",
  "Play_types.state",
  "float",
  "Geom.point",
  "bool",
  "Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "float",
  "Play_types.state",
  "float",
  "Play_types.state",
  "Play_types.userInput",
  "bool",
  "float * float",
  "Geom.Circle.t",
  "Geom.Rect.t",
  "Play_types.player",
  "int -> int",
  "Reprocessing.Events.keycodeT",
  "Geom.Circle.t",
  "Play_types.userInput -> Play_types.userInput -> Play_types.userInput",
  "Play_types.Block.t option array array",
  "float option",
  "Play_types.player",
  "Play_types.Stone.t list",
  "int",
  "int",
  "int option",
  "Play_types.Inventory.t -> Play_types.Inventory.item -> int -> unit",
  "bool -> bool -> bool",
  "Play_types.player",
  "Play_types.userInput",
  "unit",
  "int",
  "Reprocessing_Common.glEnv",
  "Play_types.state",
  "bool",
  "float",
  "Play_types.state",
  "Play_types.userInput",
  "float -> float",
  "int",
  "Play_types.player",
  "Reprocessing_Types.Types.glEnvT",
  "Play_types.player",
  "Play_types.userInput",
  "float * float * float * float",
  "float -> float -> float",
  "Geom.vector",
  "bool",
  "Play_types.Stone.t list ->\nPlay_types.Block.t option array array -> Play_types.Stone.t list",
  "int",
  "float -> float",
  "float",
  "Geom.Rect.t",
  "int",
  "(int * int) list",
  "int -> int -> bool",
  "float",
  "Reprocessing_Types.Types.glEnvT -> float",
  "(int * int) list",
  "int",
  "int -> float",
  "'e option array array",
  "Geom.vector",
  "int",
  "Reprocessing_Types.Types.glEnvT",
  "bool",
  "Play_types.userInput",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "Play_types.Block.t",
  "'e option array array -> 'f -> Play_types.player",
  "Play_types.userInput",
  "float",
  "Play_types.userInput ->\nPlay_types.player ->\nPlay_types.Stone.t list -> 'e option array array -> 'f -> Play_types.player",
  "Play_types.Block.t",
  "int * int",
  "bool -> bool -> bool",
  "Play_types.userInput",
  "float",
  "Play_types.userInput",
  "Geom.vector",
  "Play_types.Stone.t list",
  "Reprocessing.Events.keycodeT",
  "Play_types.userInput",
  "Play_types.Stone.t list",
  "Play_types.player",
  "Geom.Circle.t",
  "Play_types.Stone.t list",
  "Play_types.state",
  "Reprocessing.Events.keycodeT",
  "Play_types.player",
  "bool",
  "bool",
  "Play_types.Stone.t list",
  "bool",
  "unit",
  "Play_types.state",
  "bool",
  "Play_types.userInput",
  "Reprocessing_Types.Types.glEnvT -> int",
  "Play_types.state",
  "Play_types.Inventory.item",
  "float",
  "float -> int",
  "float",
  "Play_types.state",
  "Play_types.userInput",
  "bool",
  "bool",
  "Play_types.player",
  "'c -> Reprocessing_Common.glEnv -> Play_types.userInput",
  "float",
  "Geom.vector",
  "Geom.vector -> Geom.vector",
  "Play_types.Inventory.t",
  "Play_types.player",
  "bool",
  "Geom.Rect.t",
  "bool",
  "Play_types.Inventory.item",
  "int * int",
  "Geom.point",
  "Geom.vector",
  "int",
  "Geom.Circle.t",
  "int * int",
  "float * float * float * float",
  "Geom.Rect.t",
  "Play_types.player",
  "Play_types.Stone.t",
  "Play_types.state ->\nPlay_types.player -> Play_types.Block.t -> int -> int -> unit",
  "float option",
  "Geom.Circle.t",
  "Play_types.userInput",
  "bool",
  "unit",
  "Play_types.state",
  "bool",
  "Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "bool",
  "Play_types.userInput",
  "bool",
  "Play_types.state",
  "Play_types.Stone.t list",
  "Play_types.Block.t",
  "int",
  "Play_types.state",
  "float -> float -> float",
  "int",
  "float",
  "'f -> Play_types.player",
  "bool -> (int * int) list",
  "Play_types.userInput",
  "float option",
  "Play_types.Stone.t list",
  "Play_types.player",
  "Play_types.state",
  "Geom.vector",
  "Play_types.Stone.t",
  "int",
  "Play_types.player -> Play_types.userInput -> bool -> (int * int) list",
  "float -> float -> float",
  "Play_types.userInput",
  "float * float",
  "Play_types.userInput",
  "bool",
  "Play_types.state",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.Inventory.item * int",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.state",
  "Play_types.state",
  "Play_types.player",
  "Play_types.player",
  "bool",
  "bool",
  "int * int",
  "int",
  "bool",
  "int",
  "bool -> bool",
  "Play_types.player",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.Inventory.item -> Play_types.Inventory.item -> bool",
  "Play_types.Stone.t",
  "int",
  "Play_types.userInput",
  "Play_types.Block.t",
  "bool",
  "Play_types.player",
  "float * float * float * float",
  "Play_types.player -> Play_types.Stone.t list * Play_types.player",
  "Geom.point",
  "int",
  "Play_types.Stone.t list * Play_types.player",
  "Play_types.player",
  "Play_types.state",
  "Play_types.Stone.t list * Play_types.player ->\nPlay_types.Stone.t -> Play_types.Stone.t list * Play_types.player",
  "Play_types.state",
  "float",
  "Play_types.Stone.t list",
  "(int * int) list",
  "float",
  "Play_types.state",
  "int * int",
  "int",
  "float",
  "Play_types.Stone.t",
  "Play_types.player",
  "int",
  "Geom.point",
  "Play_types.Stone.t list ->\nPlay_types.player -> Play_types.Stone.t list * Play_types.player",
  "Play_types.Inventory.item",
  "(Play_types.Stone.t -> bool) -> Play_types.Stone.t list -> bool",
  "Reprocessing_Types.Types.glEnvT",
  "Reprocessing.Events.keycodeT",
  "Geom.vector -> float",
  "Play_types.Inventory.item",
  "float",
  "(Geom.point * Geom.vector * Play_types.Stone.t * float) option",
  "int * int",
  "bool",
  "int",
  "float",
  "(Play_types.Inventory.item * int) array",
  "bool",
  "Play_types.state",
  "'c -> Reprocessing_Common.glEnv -> Play_types.userInput",
  "bool",
  "Play_types.Stone.t list * Play_types.player",
  "[> `Jump | `Left | `Right | `JumpLeft | `JumpRight ] option",
  "Play_types.state",
  "Geom.point",
  "bool",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "Play_types.Stone.t list",
  "Play_types.state -> Reprocessing_Types.Types.glEnvT -> Play_types.userInput",
  "float",
  "float"]</script>
  <div id="type_hover">Hello</div>
<script>

  const t = document.getElementById('type_hover')
  document.getElementById('main').addEventListener('mousemove', evt => {
    t.style.top = evt.pageY + 'px'
    t.style.left = evt.pageX + 'px'
  });

  document.getElementById('main').addEventListener('mouseover', evt => {
    const id = evt.target.getAttribute('data-id')
    if (id) {
      [].map.call(document.querySelectorAll('[data-id="' + id + '"]'), el => {
        el.classList.add('hovered')
      })
    }
    let el = evt.target
    while (el && el !== document.body) {
      const type = el.getAttribute('data-type')
      if (type) {
        t.innerText = TYPES_LIST[type]
        /* console.log(TYPES_LIST[type]) */
        ;[].map.call(document.querySelectorAll('.type-hovered'), x => x.classList.remove('type-hovered'))
        el.classList.add('type-hovered')
        break
      }
      el = el.parentElement
    }
  })

  document.getElementById('main').addEventListener('mouseout', evt => {
    const id = evt.target.getAttribute('data-id')
      evt.target.classList.remove('type-hovered')
    if (id) {
      [].map.call(document.querySelectorAll('[data-id="' + id + '"]'), el => {
        el.classList.remove('hovered')
      })
    }
  })

</script>
